"use strict";(self.webpackChunkmy_page=self.webpackChunkmy_page||[]).push([[21586],{28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>d});var s=i(96540);const r={},o=s.createContext(r);function a(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(o.Provider,{value:n},e.children)}},79333:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>j,frontMatter:()=>a,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"kurs-owasp/testowanie-podatnosci/a01-broken-access-control-cwiczenie","title":"\ud83d\udee1\ufe0f 3.1.5 \u2013 Praktyczne \u0107wiczenie: Testowanie i mitigacja podatno\u015bci Broken Access Control","description":"\ud83c\udfaf Cel \u0107wiczenia","source":"@site/docs/kurs-owasp/03-testowanie-podatnosci/a01-broken-access-control-cwiczenie.md","sourceDirName":"kurs-owasp/03-testowanie-podatnosci","slug":"/kurs-owasp/testowanie-podatnosci/a01-broken-access-control-cwiczenie","permalink":"/docs/kurs-owasp/testowanie-podatnosci/a01-broken-access-control-cwiczenie","draft":false,"unlisted":false,"editUrl":"https://github.com/przemyslvw/my-page/edit/master/docs/kurs-owasp/03-testowanie-podatnosci/a01-broken-access-control-cwiczenie.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"id":"a01-broken-access-control-cwiczenie","title":"\ud83d\udee1\ufe0f 3.1.5 \u2013 Praktyczne \u0107wiczenie: Testowanie i mitigacja podatno\u015bci Broken Access Control","sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Narz\u0119dzia do testowania","permalink":"/docs/kurs-owasp/testowanie-podatnosci/a01-broken-access-control-narzedzia"},"next":{"title":"\ud83d\udd10 3.2.1 \u2013 Cryptographic Failures: Opis podatno\u015bci i jej wp\u0142yw","permalink":"/docs/kurs-owasp/testowanie-podatnosci/a02-cryptographic-failures-opis"}}');var r=i(74848),o=i(28453);const a={id:"a01-broken-access-control-cwiczenie",title:"\ud83d\udee1\ufe0f 3.1.5 \u2013 Praktyczne \u0107wiczenie: Testowanie i mitigacja podatno\u015bci Broken Access Control",sidebar_position:5},d=void 0,c={},t=[{value:"\ud83c\udfaf Cel \u0107wiczenia",id:"-cel-\u0107wiczenia",level:2},{value:"\ud83e\uddea Scenariusz testowy",id:"-scenariusz-testowy",level:2},{value:"\ud83e\uddea Krok 1: Zaloguj si\u0119 jako <code>user1</code>",id:"-krok-1-zaloguj-si\u0119-jako-user1",level:2},{value:"\ud83e\uddea Krok 2: Prze\u015blij zapytanie do swojego zam\xf3wienia",id:"-krok-2-prze\u015blij-zapytanie-do-swojego-zam\xf3wienia",level:2},{value:"\ud83e\uddea Krok 3: Spr\xf3buj uzyska\u0107 dane orderId=1002 (kt\xf3re nale\u017cy do <code>user2</code>)",id:"-krok-3-spr\xf3buj-uzyska\u0107-dane-orderid1002-kt\xf3re-nale\u017cy-do-user2",level:2},{value:"\u2705 Oczekiwane zachowanie (po naprawie)",id:"-oczekiwane-zachowanie-po-naprawie",level:2},{value:"\ud83d\udee0\ufe0f Mitigacja \u2013 backend (Node.js przyk\u0142ad)",id:"\ufe0f-mitigacja--backend-nodejs-przyk\u0142ad",level:2},{value:"\ud83e\udde0 Dodatkowe scenariusze do przetestowania",id:"-dodatkowe-scenariusze-do-przetestowania",level:2},{value:"\ud83d\udee0\ufe0f \u015arodowisko",id:"\ufe0f-\u015brodowisko",level:2},{value:"BONUS",id:"bonus",level:2},{value:"\ud83d\udd0d Scenariusz 1: Bezpo\u015bredni dost\u0119p do zasob\xf3w (IDOR)",id:"-scenariusz-1-bezpo\u015bredni-dost\u0119p-do-zasob\xf3w-idor",level:2},{value:"\ud83d\udd13 Scenariusz 2: Brak kontroli dost\u0119pu do panelu administratora",id:"-scenariusz-2-brak-kontroli-dost\u0119pu-do-panelu-administratora",level:2},{value:"\ud83e\uddea Testy przy u\u017cyciu Burp Suite",id:"-testy-przy-u\u017cyciu-burp-suite",level:2},{value:"\ud83d\udd10 Mitigacja",id:"-mitigacja",level:2},{value:"\ud83d\udcda Zadania do wykonania",id:"-zadania-do-wykonania",level:2},{value:"\ud83d\udcce \u0179r\xf3d\u0142a",id:"-\u017ar\xf3d\u0142a",level:2},{value:"\ud83e\udde0 Pro tip",id:"-pro-tip",level:2},{value:"\ud83d\udccc Podsumowanie",id:"-podsumowanie",level:2}];function l(e){const n={a:"a",br:"br",code:"code",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"-cel-\u0107wiczenia",children:"\ud83c\udfaf Cel \u0107wiczenia"}),"\n",(0,r.jsx)(n.p,{children:"W tym \u0107wiczeniu:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"przetestujesz aplikacj\u0119 podatn\u0105 na Broken Access Control (IDOR),"}),"\n",(0,r.jsx)(n.li,{children:"wykorzystasz narz\u0119dzia do przej\u0119cia danych innego u\u017cytkownika,"}),"\n",(0,r.jsxs)(n.li,{children:["zasymulujesz atak i przeprowadzisz jego ",(0,r.jsx)(n.strong,{children:"mitigacj\u0119 po stronie backendu"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-scenariusz-testowy",children:"\ud83e\uddea Scenariusz testowy"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Aplikacja"}),": System zarz\u0105dzania zam\xf3wieniami u\u017cytkownik\xf3w (REST API)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint"}),":\n",(0,r.jsx)(n.code,{children:"GET /api/orders/{orderId}"})]}),"\n",(0,r.jsxs)(n.p,{children:["U\u017cytkownik ",(0,r.jsx)(n.code,{children:"user1"})," ma przypisane zam\xf3wienie o ID ",(0,r.jsx)(n.code,{children:"1001"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"-krok-1-zaloguj-si\u0119-jako-user1",children:["\ud83e\uddea Krok 1: Zaloguj si\u0119 jako ",(0,r.jsx)(n.code,{children:"user1"})]}),"\n",(0,r.jsx)(n.p,{children:"Uzyskaj token JWT (np. w Postmanie):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "token": "eyJhbGciOiJIUzI1NiIsInR5..."\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-krok-2-prze\u015blij-zapytanie-do-swojego-zam\xf3wienia",children:"\ud83e\uddea Krok 2: Prze\u015blij zapytanie do swojego zam\xf3wienia"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"GET /api/orders/1001\nAuthorization: Bearer <token_user1>\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u27a1\ufe0f Odpowied\u017a: status ",(0,r.jsx)(n.code,{children:"200"}),", dane zam\xf3wienia ",(0,r.jsx)(n.code,{children:"user1"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"-krok-3-spr\xf3buj-uzyska\u0107-dane-orderid1002-kt\xf3re-nale\u017cy-do-user2",children:["\ud83e\uddea Krok 3: Spr\xf3buj uzyska\u0107 dane orderId=1002 (kt\xf3re nale\u017cy do ",(0,r.jsx)(n.code,{children:"user2"}),")"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"GET /api/orders/1002\nAuthorization: Bearer <token_user1>\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u27a1\ufe0f Odpowied\u017a ",(0,r.jsx)(n.code,{children:"200"})," \u2013 dane ",(0,r.jsx)(n.code,{children:"user2"}),". \ud83d\udd25 Luka IDOR!"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-oczekiwane-zachowanie-po-naprawie",children:"\u2705 Oczekiwane zachowanie (po naprawie)"}),"\n",(0,r.jsx)(n.p,{children:"Aplikacja powinna zwr\xf3ci\u0107:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"HTTP/1.1 403 Forbidden\n"})}),"\n",(0,r.jsx)(n.p,{children:"lub"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"HTTP/1.1 404 Not Found\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Je\u015bli u\u017cytkownik ",(0,r.jsx)(n.code,{children:"user1"})," nie ma dost\u0119pu do ",(0,r.jsx)(n.code,{children:"orderId=1002"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-mitigacja--backend-nodejs-przyk\u0142ad",children:"\ud83d\udee0\ufe0f Mitigacja \u2013 backend (Node.js przyk\u0142ad)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"app.get('/api/orders/:id', authenticateToken, async (req, res) => {\n  const order = await Order.findById(req.params.id);\n  if (!order || order.userId !== req.user.id) {\n    return res.status(403).json({ message: \"Access denied\" });\n  }\n  res.json(order);\n});\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-dodatkowe-scenariusze-do-przetestowania",children:"\ud83e\udde0 Dodatkowe scenariusze do przetestowania"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Modyfikacja ",(0,r.jsx)(n.code,{children:"userId"})," w \u017c\u0105daniu ",(0,r.jsx)(n.code,{children:"POST"})," / ",(0,r.jsx)(n.code,{children:"PUT"})]}),"\n",(0,r.jsxs)(n.li,{children:["Zmiana r\xf3l w formularzu (ukryte pola ",(0,r.jsx)(n.code,{children:"role=admin"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Wywo\u0142anie endpoint\xf3w ",(0,r.jsx)(n.code,{children:"/admin"})," jako u\u017cytkownik nieuprzywilejowany"]}),"\n",(0,r.jsx)(n.li,{children:"Token JWT innego u\u017cytkownika \u2013 por\xf3wnanie odpowiedzi"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-\u015brodowisko",children:"\ud83d\udee0\ufe0f \u015arodowisko"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Aplikacja testowa:"})," ",(0,r.jsx)(n.a,{href:"https://owasp.org/www-project-juice-shop/",children:"OWASP Juice Shop"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"System operacyjny:"})," Kali Linux / Parrot OS / inna dystrybucja z narz\u0119dziami pentestowymi"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Przegl\u0105darka:"})," Firefox z dodatkami:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"FoxyProxy"}),"\n",(0,r.jsx)(n.li,{children:"HackBar / RESTer"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Proxy:"})," Burp Suite Community lub Pro"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"bonus",children:"BONUS"}),"\n",(0,r.jsx)(n.h2,{id:"-scenariusz-1-bezpo\u015bredni-dost\u0119p-do-zasob\xf3w-idor",children:"\ud83d\udd0d Scenariusz 1: Bezpo\u015bredni dost\u0119p do zasob\xf3w (IDOR)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Zaloguj si\u0119 jako zwyk\u0142y u\u017cytkownik."}),"\n",(0,r.jsx)(n.li,{children:"Przejd\u017a do historii zam\xf3wie\u0144 lub danych konta."}),"\n",(0,r.jsxs)(n.li,{children:["Zidentyfikuj parametr z ID (np. ",(0,r.jsx)(n.code,{children:"orderId=123"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Zmie\u0144 ID w adresie URL na inny (np. ",(0,r.jsx)(n.code,{children:"orderId=124"}),") i sprawd\u017a, czy masz dost\u0119p do cudzych danych."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Oczekiwany wynik:"})," Mo\u017cliwo\u015b\u0107 przegl\u0105dania danych innych u\u017cytkownik\xf3w oznacza podatno\u015b\u0107 typu IDOR."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-scenariusz-2-brak-kontroli-dost\u0119pu-do-panelu-administratora",children:"\ud83d\udd13 Scenariusz 2: Brak kontroli dost\u0119pu do panelu administratora"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Wejd\u017a bezpo\u015brednio na URL ",(0,r.jsx)(n.code,{children:"/admin"})," lub ",(0,r.jsx)(n.code,{children:"/api/users"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Sprawd\u017a, czy serwer zwraca dane mimo braku autoryzacji."}),"\n",(0,r.jsxs)(n.li,{children:["Przetestuj dost\u0119p za pomoc\u0105 zmodyfikowanych ciastek sesyjnych (np. ",(0,r.jsx)(n.code,{children:"role=admin"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Oczekiwany wynik:"})," Uzyskanie dost\u0119pu bez odpowiednich uprawnie\u0144."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-testy-przy-u\u017cyciu-burp-suite",children:"\ud83e\uddea Testy przy u\u017cyciu Burp Suite"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["U\u017cyj ",(0,r.jsx)(n.strong,{children:"Proxy"})," do przechwytywania \u017c\u0105da\u0144."]}),"\n",(0,r.jsx)(n.li,{children:"Zidentyfikuj endpointy zale\u017cne od uprawnie\u0144 u\u017cytkownika."}),"\n",(0,r.jsxs)(n.li,{children:["U\u017cyj ",(0,r.jsx)(n.strong,{children:"Intrudera"})," do fuzzowania parametr\xf3w ID/role."]}),"\n",(0,r.jsxs)(n.li,{children:["Sprawd\u017a odpowiedzi HTTP (",(0,r.jsx)(n.code,{children:"200 OK"}),", ",(0,r.jsx)(n.code,{children:"403 Forbidden"}),", ",(0,r.jsx)(n.code,{children:"401 Unauthorized"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-mitigacja",children:"\ud83d\udd10 Mitigacja"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Zasada minimalnych uprawnie\u0144"})," \u2013 u\u017cytkownicy powinni mie\u0107 dost\u0119p tylko do tego, co jest im potrzebne."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Weryfikacja po stronie serwera"})," \u2013 nie ufaj danym z klienta."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Modele r\xf3l i uprawnie\u0144"})," \u2013 stosuj mechanizmy RBAC (Role-Based Access Control)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Testy automatyczne uprawnie\u0144"})," \u2013 integruj z CI/CD."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Audyt log\xf3w"})," \u2013 loguj nieudane pr\xf3by dost\u0119pu."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-zadania-do-wykonania",children:"\ud83d\udcda Zadania do wykonania"}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 Zidentyfikuj co najmniej jedn\u0105 funkcj\u0119 podatn\u0105 na Broken Access Control.",(0,r.jsx)(n.br,{}),"\n","\u2705 Przeprowad\u017a atak (np. IDOR lub dost\u0119p do ukrytego endpointa).",(0,r.jsx)(n.br,{}),"\n","\u2705 Zapisz wynik testu i dow\xf3d (zrzut ekranu, odpowied\u017a HTTP).",(0,r.jsx)(n.br,{}),"\n","\u2705 Opracuj rekomendacj\u0119 mitigacji.",(0,r.jsx)(n.br,{}),"\n","\u2705 Umie\u015b\u0107 wyniki w raporcie ko\u0144cowym."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-\u017ar\xf3d\u0142a",children:"\ud83d\udcce \u0179r\xf3d\u0142a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html",children:"OWASP Cheat Sheet: Access Control"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://owasp-juice.shop/",children:"OWASP Juice Shop Guide"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-pro-tip",children:"\ud83e\udde0 Pro tip"}),"\n",(0,r.jsxs)(n.p,{children:["\ud83d\udd01 Automatyzuj testy uprawnie\u0144 za pomoc\u0105 ",(0,r.jsx)(n.strong,{children:"ZAP scripts"})," lub ",(0,r.jsx)(n.strong,{children:"Postman tests"}),".",(0,r.jsx)(n.br,{}),"\n","\ud83e\uddea U\u017cywaj ",(0,r.jsx)(n.strong,{children:"JWT debugger\xf3w"})," do analizy token\xf3w i test\xf3w zmiany uprawnie\u0144."]}),"\n",(0,r.jsx)(n.h2,{id:"-podsumowanie",children:"\ud83d\udccc Podsumowanie"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Broken Access Control"})," to jeden z niewielu b\u0142\u0119d\xf3w, kt\xf3ry mo\u017cesz wykry\u0107 w ci\u0105gu kilku minut \u2013 a jego skutki mog\u0105 by\u0107 krytyczne. Regularne testowanie logiki uprawnie\u0144 to obowi\u0105zek ka\u017cdej organizacji."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:["W nast\u0119pnym rozdziale przejdziemy do ",(0,r.jsx)(n.code,{children:"A02:2025 \u2013 Cryptographic Failures"}),"."]})]})}function j(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}}}]);