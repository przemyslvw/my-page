"use strict";(self.webpackChunkmy_page=self.webpackChunkmy_page||[]).push([[61647],{28453:(e,i,n)=>{n.d(i,{R:()=>o,x:()=>r});var a=n(96540);const s={},c=a.createContext(s);function o(e){const i=a.useContext(c);return a.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(c.Provider,{value:i},e.children)}},95016:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>t,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"kurs-owasp/testowanie-podatnosci/a04-insecure-design-cwiczenie","title":"\ud83e\uddea 3.4.5 \u2013 Praktyczne \u0107wiczenie: Testowanie i mitigacja","description":"\ud83c\udfaf Cel \u0107wiczenia","source":"@site/docs/kurs-owasp/03-testowanie-podatnosci/a04-insecure-design-cwiczenie.md","sourceDirName":"kurs-owasp/03-testowanie-podatnosci","slug":"/kurs-owasp/testowanie-podatnosci/a04-insecure-design-cwiczenie","permalink":"/docs/kurs-owasp/testowanie-podatnosci/a04-insecure-design-cwiczenie","draft":false,"unlisted":false,"editUrl":"https://github.com/przemyslvw/my-page/edit/master/docs/kurs-owasp/03-testowanie-podatnosci/a04-insecure-design-cwiczenie.md","tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"id":"a04-insecure-design-cwiczenie","title":"\ud83e\uddea 3.4.5 \u2013 Praktyczne \u0107wiczenie: Testowanie i mitigacja","sidebar_position":20},"sidebar":"tutorialSidebar","previous":{"title":"\ud83e\uddf0 3.4.4 \u2013 Narz\u0119dzia do testowania","permalink":"/docs/kurs-owasp/testowanie-podatnosci/a04-insecure-design-narzedzia"},"next":{"title":"Opis podatno\u015bci i jej wp\u0142yw","permalink":"/docs/kurs-owasp/testowanie-podatnosci/a05-security-misconfiguration-opis"}}');var s=n(74848),c=n(28453);const o={id:"a04-insecure-design-cwiczenie",title:"\ud83e\uddea 3.4.5 \u2013 Praktyczne \u0107wiczenie: Testowanie i mitigacja",sidebar_position:20},r=void 0,t={},d=[{value:"\ud83c\udfaf Cel \u0107wiczenia",id:"-cel-\u0107wiczenia",level:2},{value:"\ud83e\uddea Scenariusz 1: Brak kontroli w\u0142a\u015bciciela zasobu",id:"-scenariusz-1-brak-kontroli-w\u0142a\u015bciciela-zasobu",level:2},{value:"Krok 1: U\u017cytkownik <code>userA</code> loguje si\u0119 i uzyskuje token.",id:"krok-1-u\u017cytkownik-usera-loguje-si\u0119-i-uzyskuje-token",level:3},{value:"Krok 2: Wysy\u0142a zapytanie:",id:"krok-2-wysy\u0142a-zapytanie",level:3},{value:"\u2705 Mitigacja:",id:"-mitigacja",level:3},{value:"\ud83e\uddea Scenariusz 2: Brak walidacji etap\xf3w procesu (np. zakup)",id:"-scenariusz-2-brak-walidacji-etap\xf3w-procesu-np-zakup",level:2},{value:"Krok 1: Wys\u0142anie zapytania do <code>POST /checkout/confirm</code> bez wcze\u015bniejszej p\u0142atno\u015bci.",id:"krok-1-wys\u0142anie-zapytania-do-post-checkoutconfirm-bez-wcze\u015bniejszej-p\u0142atno\u015bci",level:3},{value:"\u2705 Mitigacja:",id:"-mitigacja-1",level:3},{value:"\ud83e\uddea Scenariusz 3: Mo\u017cliwo\u015b\u0107 manipulacji ID przez przewidywalno\u015b\u0107",id:"-scenariusz-3-mo\u017cliwo\u015b\u0107-manipulacji-id-przez-przewidywalno\u015b\u0107",level:2},{value:"\u2705 Mitigacja:",id:"-mitigacja-2",level:3},{value:"\u2705 Zadania do wykonania",id:"-zadania-do-wykonania",level:2},{value:"\ud83e\udde0 Dodatkowe pomys\u0142y testowe",id:"-dodatkowe-pomys\u0142y-testowe",level:2},{value:"\ud83e\uddea Zrealizowane scenariusze",id:"-zrealizowane-scenariusze",level:2},{value:"\ud83e\uddea Scenariusz: Brak walidacji w\u0142a\u015bciciela zasobu",id:"-scenariusz-brak-walidacji-w\u0142a\u015bciciela-zasobu",level:3},{value:"\ud83e\uddea Scenariusz: Pomini\u0119cie p\u0142atno\u015bci w procesie checkout",id:"-scenariusz-pomini\u0119cie-p\u0142atno\u015bci-w-procesie-checkout",level:3},{value:"\ud83e\udde0 Wnioski z test\xf3w",id:"-wnioski-z-test\xf3w",level:3},{value:"\ud83d\udccb Do raportu ko\u0144cowego",id:"-do-raportu-ko\u0144cowego",level:2}];function l(e){const i={code:"code",h2:"h2",h3:"h3",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.h2,{id:"-cel-\u0107wiczenia",children:"\ud83c\udfaf Cel \u0107wiczenia"}),"\n",(0,s.jsx)(i.p,{children:"Zidentyfikowa\u0107 i wykorzysta\u0107 b\u0142\u0119dy projektowe w aplikacji (Insecure Design), kt\xf3re nie wynikaj\u0105 z b\u0142\u0119dnej implementacji, lecz z braku za\u0142o\u017ce\u0144 bezpiecze\u0144stwa w logice dzia\u0142ania aplikacji."}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-scenariusz-1-brak-kontroli-w\u0142a\u015bciciela-zasobu",children:"\ud83e\uddea Scenariusz 1: Brak kontroli w\u0142a\u015bciciela zasobu"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Aplikacja:"})," REST API do zam\xf3wie\u0144"]}),"\n",(0,s.jsxs)(i.h3,{id:"krok-1-u\u017cytkownik-usera-loguje-si\u0119-i-uzyskuje-token",children:["Krok 1: U\u017cytkownik ",(0,s.jsx)(i.code,{children:"userA"})," loguje si\u0119 i uzyskuje token."]}),"\n",(0,s.jsx)(i.h3,{id:"krok-2-wysy\u0142a-zapytanie",children:"Krok 2: Wysy\u0142a zapytanie:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-http",children:"GET /orders/1002\nAuthorization: Bearer <token_userA>\n"})}),"\n",(0,s.jsxs)(i.p,{children:["\u27a1\ufe0f Aplikacja zwraca dane ",(0,s.jsx)(i.code,{children:"orderId=1002"}),", mimo \u017ce zam\xf3wienie nale\u017cy do ",(0,s.jsx)(i.code,{children:"userB"}),"."]}),"\n",(0,s.jsx)(i.h3,{id:"-mitigacja",children:"\u2705 Mitigacja:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Dodaj sprawdzenie w\u0142a\u015bciciela zasobu na poziomie kontrolera lub w warstwie serwisu."}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-scenariusz-2-brak-walidacji-etap\xf3w-procesu-np-zakup",children:"\ud83e\uddea Scenariusz 2: Brak walidacji etap\xf3w procesu (np. zakup)"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Aplikacja:"})," E-commerce \u2013 u\u017cytkownik mo\u017ce przej\u015b\u0107 od koszyka do \u201ezam\xf3wione\u201d bez p\u0142atno\u015bci."]}),"\n",(0,s.jsxs)(i.h3,{id:"krok-1-wys\u0142anie-zapytania-do-post-checkoutconfirm-bez-wcze\u015bniejszej-p\u0142atno\u015bci",children:["Krok 1: Wys\u0142anie zapytania do ",(0,s.jsx)(i.code,{children:"POST /checkout/confirm"})," bez wcze\u015bniejszej p\u0142atno\u015bci."]}),"\n",(0,s.jsx)(i.p,{children:"\u27a1\ufe0f Zam\xf3wienie zostaje z\u0142o\u017cone."}),"\n",(0,s.jsx)(i.h3,{id:"-mitigacja-1",children:"\u2705 Mitigacja:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Wprowad\u017a kontrol\u0119 statusu (np. ",(0,s.jsx)(i.code,{children:"cart -> payment -> confirmed"}),")."]}),"\n",(0,s.jsx)(i.li,{children:"Waliduj etap procesu na backendzie niezale\u017cnie od klienta."}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-scenariusz-3-mo\u017cliwo\u015b\u0107-manipulacji-id-przez-przewidywalno\u015b\u0107",children:"\ud83e\uddea Scenariusz 3: Mo\u017cliwo\u015b\u0107 manipulacji ID przez przewidywalno\u015b\u0107"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-http",children:"GET /invoice/1001\nGET /invoice/1002\n"})}),"\n",(0,s.jsx)(i.p,{children:"\u27a1\ufe0f Brak walidacji dost\u0119pu, brak tokenizacji / UUID / ACL."}),"\n",(0,s.jsx)(i.h3,{id:"-mitigacja-2",children:"\u2705 Mitigacja:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"U\u017cywaj identyfikator\xf3w trudnych do zgadni\u0119cia (np. UUID)."}),"\n",(0,s.jsx)(i.li,{children:"Wprowad\u017a kontrol\u0119 dost\u0119pu do danych na poziomie identyfikatora."}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-zadania-do-wykonania",children:"\u2705 Zadania do wykonania"}),"\n",(0,s.jsxs)(i.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(i.li,{className:"task-list-item",children:[(0,s.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Wybierz 1 scenariusz i wykonaj test."]}),"\n",(0,s.jsxs)(i.li,{className:"task-list-item",children:[(0,s.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Udokumentuj wynik testu (payload, zachowanie aplikacji)."]}),"\n",(0,s.jsxs)(i.li,{className:"task-list-item",children:[(0,s.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Zarekomenduj poprawk\u0119 architektoniczn\u0105."]}),"\n",(0,s.jsxs)(i.li,{className:"task-list-item",children:[(0,s.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Uwzgl\u0119dnij w raporcie ko\u0144cowym jako przypadek Insecure Design."]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-dodatkowe-pomys\u0142y-testowe",children:"\ud83e\udde0 Dodatkowe pomys\u0142y testowe"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Czy mo\u017cna przyspieszy\u0107 proces rejestracji/aktywacji pomijaj\u0105c kroki?"}),"\n",(0,s.jsx)(i.li,{children:"Czy mo\u017cna zmieni\u0107 status zam\xf3wienia przez API bez roli?"}),"\n",(0,s.jsx)(i.li,{children:"Czy dane klienta s\u0105 przesy\u0142ane na podstawie danych sesji, czy klienta?"}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-zrealizowane-scenariusze",children:"\ud83e\uddea Zrealizowane scenariusze"}),"\n",(0,s.jsx)(i.h3,{id:"-scenariusz-brak-walidacji-w\u0142a\u015bciciela-zasobu",children:"\ud83e\uddea Scenariusz: Brak walidacji w\u0142a\u015bciciela zasobu"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Testowany endpoint:"})}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"GET /orders/1002\nAuthorization: Bearer userA-token\n"})}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Wynik testu:"}),"\nAplikacja zwr\xf3ci\u0142a dane zam\xf3wienia nale\u017c\u0105ce do innego u\u017cytkownika (",(0,s.jsx)(i.code,{children:"userB"}),"). Brak walidacji w\u0142a\u015bciciela zasobu po stronie backendu."]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Payload:"})}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-http",children:"GET /orders/1002\nAuthorization: Bearer eyJhbGciOiJIUzI1...\n"})}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Zachowanie aplikacji:"})," 200 OK + pe\u0142ne dane zam\xf3wienia"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Rekomendacja:"}),"\nDoda\u0107 walidacj\u0119 ",(0,s.jsx)(i.code,{children:"order.UserId == currentUser.Id"})," w kontrolerze. Przyk\u0142ad (C#):"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-csharp",children:"if (order.UserId != currentUser.Id)\n    return Forbid();\n"})}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h3,{id:"-scenariusz-pomini\u0119cie-p\u0142atno\u015bci-w-procesie-checkout",children:"\ud83e\uddea Scenariusz: Pomini\u0119cie p\u0142atno\u015bci w procesie checkout"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Testowany endpoint:"})}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"POST /checkout/confirm\n"})}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Wynik testu:"}),"\nZam\xf3wienie zosta\u0142o utworzone mimo braku zako\u0144czonego procesu p\u0142atno\u015bci."]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Payload:"})}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-json",children:'{ "cartId": "c123", "step": "confirm" }\n'})}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Zachowanie aplikacji:"})," 201 Created \u2013 zam\xf3wienie potwierdzone"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Rekomendacja:"}),"\nWymusi\u0107 w backendzie status przej\u015bciowy \u2013 ",(0,s.jsx)(i.code,{children:"status != paid"})," \u2192 brak mo\u017cliwo\u015bci ",(0,s.jsx)(i.code,{children:"confirm"}),"."]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h3,{id:"-wnioski-z-test\xf3w",children:"\ud83e\udde0 Wnioski z test\xf3w"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Brak kontroli stanu i w\u0142a\u015bciciela to typowe symptomy ",(0,s.jsx)(i.strong,{children:"Insecure Design"}),"."]}),"\n",(0,s.jsxs)(i.li,{children:["Aplikacja przyjmuje poprawne zapytania, ale ",(0,s.jsx)(i.strong,{children:"brakuje walidacji ich sensu i kolejno\u015bci"}),"."]}),"\n",(0,s.jsx)(i.li,{children:"Automatyczne testy rzadko wykrywaj\u0105 ten problem \u2013 niezb\u0119dne testy logiczne."}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-do-raportu-ko\u0144cowego",children:"\ud83d\udccb Do raportu ko\u0144cowego"}),"\n",(0,s.jsx)(i.p,{children:"Zalecenia:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Zmiana projekt\xf3w proces\xf3w zakupowych, logowania, dost\u0119pu do zasob\xf3w."}),"\n",(0,s.jsx)(i.li,{children:"Wdro\u017cenie dodatkowych walidacji kontekstowych na backendzie."}),"\n",(0,s.jsx)(i.li,{children:"Analiza wszystkich funkcji pod k\u0105tem za\u0142o\u017ce\u0144 bezpiecze\u0144stwa."}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.p,{children:["W kolejnym rozdziale: ",(0,s.jsx)(i.strong,{children:"3.5 \u2013 Security Misconfiguration"})]})]})}function p(e={}){const{wrapper:i}={...(0,c.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);