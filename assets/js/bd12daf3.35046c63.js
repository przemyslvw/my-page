"use strict";(self.webpackChunkmy_page=self.webpackChunkmy_page||[]).push([[25780],{28453:(e,i,a)=>{a.d(i,{R:()=>l,x:()=>c});var n=a(96540);const s={},r=n.createContext(s);function l(e){const i=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),n.createElement(r.Provider,{value:i},e.children)}},95835:(e,i,a)=>{a.r(i),a.d(i,{assets:()=>o,contentTitle:()=>c,default:()=>j,frontMatter:()=>l,metadata:()=>n,toc:()=>t});const n=JSON.parse('{"id":"kurs-owasp/testowanie-podatnosci/a02-cryptographic-failures-cwiczenie","title":"Praktyczne \u0107wiczenie: Testowanie i mitigacja","description":"\ud83c\udfaf Cel \u0107wiczenia","source":"@site/docs/kurs-owasp/03-testowanie-podatnosci/a02-cryptographic-failures-cwiczenie.md","sourceDirName":"kurs-owasp/03-testowanie-podatnosci","slug":"/kurs-owasp/testowanie-podatnosci/a02-cryptographic-failures-cwiczenie","permalink":"/docs/kurs-owasp/testowanie-podatnosci/a02-cryptographic-failures-cwiczenie","draft":false,"unlisted":false,"editUrl":"https://github.com/przemyslvw/my-page/edit/master/docs/kurs-owasp/03-testowanie-podatnosci/a02-cryptographic-failures-cwiczenie.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"id":"a02-cryptographic-failures-cwiczenie","title":"Praktyczne \u0107wiczenie: Testowanie i mitigacja","sidebar_position":10},"sidebar":"tutorialSidebar","previous":{"title":"\ud83e\uddf0 3.2.4 \u2013 Narz\u0119dzia do testowania: Cryptographic Failures","permalink":"/docs/kurs-owasp/testowanie-podatnosci/a02-cryptographic-failures-narzedzia"},"next":{"title":"\ud83d\udc89 3.3.1 \u2013 Opis podatno\u015bci i jej wp\u0142yw","permalink":"/docs/kurs-owasp/testowanie-podatnosci/a03-injection-opis"}}');var s=a(74848),r=a(28453);const l={id:"a02-cryptographic-failures-cwiczenie",title:"Praktyczne \u0107wiczenie: Testowanie i mitigacja",sidebar_position:10},c=void 0,o={},t=[{value:"\ud83c\udfaf Cel \u0107wiczenia",id:"-cel-\u0107wiczenia",level:2},{value:"\ud83e\uddea Scenariusz testowy 1: JWT bez podpisu (<code>alg: none</code>)",id:"-scenariusz-testowy-1-jwt-bez-podpisu-alg-none",level:2},{value:"Krok 1: Przechwy\u0107 token JWT",id:"krok-1-przechwy\u0107-token-jwt",level:3},{value:"Krok 2: Zmie\u0144 algorytm",id:"krok-2-zmie\u0144-algorytm",level:3},{value:"\ud83d\udee0\ufe0f Mitigacja (Node.js example)",id:"\ufe0f-mitigacja-nodejs-example",level:2},{value:"\ud83e\uddea Scenariusz testowy 2: Has\u0142a w plaintext",id:"-scenariusz-testowy-2-has\u0142a-w-plaintext",level:2},{value:"Krok 1: Zbadaj kolumn\u0119 <code>password</code>",id:"krok-1-zbadaj-kolumn\u0119-password",level:3},{value:"\ud83d\udee0\ufe0f Mitigacja \u2013 Hashowanie hase\u0142",id:"\ufe0f-mitigacja--hashowanie-hase\u0142",level:2},{value:"\ud83e\uddea Scenariusz testowy 3: Brak HTTPS",id:"-scenariusz-testowy-3-brak-https",level:2},{value:"Krok 1: Otw\xf3rz aplikacj\u0119 bez HTTPS",id:"krok-1-otw\xf3rz-aplikacj\u0119-bez-https",level:3},{value:"\ud83d\udee0\ufe0f Mitigacja",id:"\ufe0f-mitigacja",level:2},{value:"\ud83e\uddea Scenariusz testowy 4: Twardo zakodowany klucz szyfruj\u0105cy",id:"-scenariusz-testowy-4-twardo-zakodowany-klucz-szyfruj\u0105cy",level:2},{value:"Krok 1: Znajd\u017a hardcoded klucz",id:"krok-1-znajd\u017a-hardcoded-klucz",level:3},{value:"\u2705 Zadania do wykonania",id:"-zadania-do-wykonania",level:2},{value:"\ud83e\udde0 Dodatkowe \u0107wiczenia",id:"-dodatkowe-\u0107wiczenia",level:2},{value:"\ud83d\udd0d 1. Przeanalizuj JWT z aplikacji mobilnej",id:"-1-przeanalizuj-jwt-z-aplikacji-mobilnej",level:3},{value:"\ud83d\udd10 2. Sprawd\u017a konfiguracj\u0119 TLS/SSL aplikacji",id:"-2-sprawd\u017a-konfiguracj\u0119-tlsssl-aplikacji",level:3},{value:"\ud83e\uddec 3. Zidentyfikuj sekrety w repozytorium kodu",id:"-3-zidentyfikuj-sekrety-w-repozytorium-kodu",level:3},{value:"Opcja A: TruffleHog",id:"opcja-a-trufflehog",level:4},{value:"Opcja B: Gitleaks",id:"opcja-b-gitleaks",level:4}];function d(e){const i={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.h2,{id:"-cel-\u0107wiczenia",children:"\ud83c\udfaf Cel \u0107wiczenia"}),"\n",(0,s.jsx)(i.p,{children:"Przetestowa\u0107 aplikacj\u0119 pod k\u0105tem b\u0142\u0119d\xf3w kryptograficznych:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"przechowywania hase\u0142 w plaintext,"}),"\n",(0,s.jsx)(i.li,{children:"akceptacji JWT bez podpisu,"}),"\n",(0,s.jsx)(i.li,{children:"braku HTTPS,"}),"\n",(0,s.jsx)(i.li,{children:"twardo zakodowanych kluczy szyfruj\u0105cych."}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.h2,{id:"-scenariusz-testowy-1-jwt-bez-podpisu-alg-none",children:["\ud83e\uddea Scenariusz testowy 1: JWT bez podpisu (",(0,s.jsx)(i.code,{children:"alg: none"}),")"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Aplikacja:"})," REST API z JWT (symulowane lub Juice Shop + Burp Suite)"]}),"\n",(0,s.jsx)(i.h3,{id:"krok-1-przechwy\u0107-token-jwt",children:"Krok 1: Przechwy\u0107 token JWT"}),"\n",(0,s.jsxs)(i.p,{children:["Zaloguj si\u0119 jako zwyk\u0142y u\u017cytkownik i zapisz token z nag\u0142\xf3wka ",(0,s.jsx)(i.code,{children:"Authorization"}),"."]}),"\n",(0,s.jsx)(i.h3,{id:"krok-2-zmie\u0144-algorytm",children:"Krok 2: Zmie\u0144 algorytm"}),"\n",(0,s.jsx)(i.p,{children:"Za pomoc\u0105 jwt.io lub Burp Suite Decoder zmodyfikuj nag\u0142\xf3wek JWT:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-json",children:'{\n  "alg": "none",\n  "typ": "JWT"\n}\n'})}),"\n",(0,s.jsx)(i.p,{children:"Dodaj dowolny payload, np.:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-json",children:'{\n  "username": "admin",\n  "role": "admin"\n}\n'})}),"\n",(0,s.jsx)(i.p,{children:"Usu\u0144 podpis i wy\u015blij \u017c\u0105danie z takim tokenem."}),"\n",(0,s.jsxs)(i.p,{children:["\u27a1\ufe0f Je\u015bli serwer go akceptuje: ",(0,s.jsx)(i.strong,{children:"krytyczna luka"}),"."]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"\ufe0f-mitigacja-nodejs-example",children:"\ud83d\udee0\ufe0f Mitigacja (Node.js example)"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-javascript",children:"jwt.verify(token, secret, { algorithms: ['HS256'] });\n"})}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-scenariusz-testowy-2-has\u0142a-w-plaintext",children:"\ud83e\uddea Scenariusz testowy 2: Has\u0142a w plaintext"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Aplikacja:"})," Dump bazy danych z tabel\u0105 ",(0,s.jsx)(i.code,{children:"users"})]}),"\n",(0,s.jsxs)(i.h3,{id:"krok-1-zbadaj-kolumn\u0119-password",children:["Krok 1: Zbadaj kolumn\u0119 ",(0,s.jsx)(i.code,{children:"password"})]}),"\n",(0,s.jsxs)(i.p,{children:["Je\u015bli zawarto\u015b\u0107 to np. ",(0,s.jsx)(i.code,{children:"admin123"}),", a nie hash (np. ",(0,s.jsx)(i.code,{children:"$2b$12$..."}),") \u2013 has\u0142a s\u0105 przechowywane w formie jawnej."]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"\ufe0f-mitigacja--hashowanie-hase\u0142",children:"\ud83d\udee0\ufe0f Mitigacja \u2013 Hashowanie hase\u0142"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-javascript",children:"const bcrypt = require('bcrypt');\nconst hash = await bcrypt.hash('admin123', 12);\n"})}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-scenariusz-testowy-3-brak-https",children:"\ud83e\uddea Scenariusz testowy 3: Brak HTTPS"}),"\n",(0,s.jsx)(i.h3,{id:"krok-1-otw\xf3rz-aplikacj\u0119-bez-https",children:"Krok 1: Otw\xf3rz aplikacj\u0119 bez HTTPS"}),"\n",(0,s.jsxs)(i.p,{children:["U\u017cyj ",(0,s.jsx)(i.code,{children:"curl"}),":"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-bash",children:"curl -v http://example.com/login\n"})}),"\n",(0,s.jsx)(i.p,{children:"Je\u015bli przesy\u0142ane s\u0105 dane logowania \u2013 aplikacja nara\u017cona na MITM."}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"\ufe0f-mitigacja",children:"\ud83d\udee0\ufe0f Mitigacja"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Wymusi\u0107 HTTPS w aplikacji i serwerze."}),"\n",(0,s.jsxs)(i.li,{children:["Doda\u0107 ",(0,s.jsx)(i.code,{children:"HSTS"})," w nag\u0142\xf3wkach:"]}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-http",children:"Strict-Transport-Security: max-age=31536000; includeSubDomains\n"})}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-scenariusz-testowy-4-twardo-zakodowany-klucz-szyfruj\u0105cy",children:"\ud83e\uddea Scenariusz testowy 4: Twardo zakodowany klucz szyfruj\u0105cy"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Aplikacja:"})," JavaScript w frontendzie"]}),"\n",(0,s.jsx)(i.h3,{id:"krok-1-znajd\u017a-hardcoded-klucz",children:"Krok 1: Znajd\u017a hardcoded klucz"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-js",children:'const key = "my-secret-key"; // \u274c z\u0142y przyk\u0142ad\n'})}),"\n",(0,s.jsx)(i.p,{children:"\u27a1\ufe0f Atakuj\u0105cy mo\u017ce go u\u017cy\u0107 do deszyfrowania danych u\u017cytkownika."}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-zadania-do-wykonania",children:"\u2705 Zadania do wykonania"}),"\n",(0,s.jsxs)(i.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(i.li,{className:"task-list-item",children:[(0,s.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Zidentyfikuj i wykorzystaj co najmniej jedn\u0105 luk\u0119 kryptograficzn\u0105."]}),"\n",(0,s.jsxs)(i.li,{className:"task-list-item",children:[(0,s.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Udokumentuj dowody (screeny, \u017c\u0105dania/odpowiedzi)."]}),"\n",(0,s.jsxs)(i.li,{className:"task-list-item",children:[(0,s.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Zaproponuj poprawk\u0119 (mitigacja)."]}),"\n",(0,s.jsxs)(i.li,{className:"task-list-item",children:[(0,s.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Uwzgl\u0119dnij wynik w raporcie ko\u0144cowym."]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"-dodatkowe-\u0107wiczenia",children:"\ud83e\udde0 Dodatkowe \u0107wiczenia"}),"\n",(0,s.jsx)(i.h3,{id:"-1-przeanalizuj-jwt-z-aplikacji-mobilnej",children:"\ud83d\udd0d 1. Przeanalizuj JWT z aplikacji mobilnej"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsx)(i.li,{children:"Zainstaluj emulator (np. Android Studio / Genymotion)."}),"\n",(0,s.jsx)(i.li,{children:"Uruchom aplikacj\u0119 mobiln\u0105 i przechwy\u0107 ruch sieciowy za pomoc\u0105 Burp Suite lub mitmproxy."}),"\n",(0,s.jsx)(i.li,{children:"Znajd\u017a token JWT przesy\u0142any przez aplikacj\u0119."}),"\n",(0,s.jsxs)(i.li,{children:["Skopiuj token i przeanalizuj go na stronie ",(0,s.jsx)(i.a,{href:"https://jwt.io",children:"jwt.io"}),"."]}),"\n",(0,s.jsxs)(i.li,{children:["Sprawd\u017a:","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Czy JWT ma ",(0,s.jsx)(i.code,{children:"alg: none"}),"?"]}),"\n",(0,s.jsx)(i.li,{children:"Czy payload zawiera informacje u\u017cytkownika?"}),"\n",(0,s.jsx)(i.li,{children:"Czy mo\u017cna go zmodyfikowa\u0107 bez b\u0142\u0119du po stronie serwera?"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h3,{id:"-2-sprawd\u017a-konfiguracj\u0119-tlsssl-aplikacji",children:"\ud83d\udd10 2. Sprawd\u017a konfiguracj\u0119 TLS/SSL aplikacji"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsxs)(i.li,{children:["Zainstaluj ",(0,s.jsx)(i.a,{href:"https://github.com/drwetter/testssl.sh",children:"testssl.sh"}),"."]}),"\n",(0,s.jsx)(i.li,{children:"Uruchom test dla aplikacji:"}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-bash",children:"./testssl.sh https://twoja-aplikacja.pl\n"})}),"\n",(0,s.jsxs)(i.ol,{start:"3",children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"Przeanalizuj:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Dost\u0119pne wersje protoko\u0142\xf3w TLS."}),"\n",(0,s.jsx)(i.li,{children:"Cipher Suites."}),"\n",(0,s.jsx)(i.li,{children:"Certyfikat i jego wa\u017cno\u015b\u0107."}),"\n",(0,s.jsx)(i.li,{children:"Obecno\u015b\u0107 HSTS."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["Alternatywnie, u\u017cyj ",(0,s.jsx)(i.a,{href:"https://www.ssllabs.com/ssltest/",children:"SSL Labs"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h3,{id:"-3-zidentyfikuj-sekrety-w-repozytorium-kodu",children:"\ud83e\uddec 3. Zidentyfikuj sekrety w repozytorium kodu"}),"\n",(0,s.jsx)(i.h4,{id:"opcja-a-trufflehog",children:"Opcja A: TruffleHog"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-bash",children:"trufflehog github --repo=https://github.com/twoj-org/twoj-repo\n"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Szuka zakodowanych kluczy API, token\xf3w, hase\u0142."}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"opcja-b-gitleaks",children:"Opcja B: Gitleaks"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-bash",children:"gitleaks detect --source=.\n"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Lekka alternatywa, mo\u017cliwa do integracji z CI/CD."}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"\ud83d\udccc Sprawd\u017a, czy repozytorium nie zawiera:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.code,{children:"AWS_SECRET_KEY"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.code,{children:"JWT_SECRET"})}),"\n",(0,s.jsx)(i.li,{children:"Twardo zakodowanych hase\u0142 lub kluczy prywatnych"}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.p,{children:["W nast\u0119pnym rozdziale: ",(0,s.jsx)(i.strong,{children:"3.3 \u2013 Injection"})]})]})}function j(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);