"use strict";(self.webpackChunkmy_page=self.webpackChunkmy_page||[]).push([[90206],{28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var a=i(96540);const s={},c=a.createContext(s);function o(e){const n=a.useContext(c);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(c.Provider,{value:n},e.children)}},70275:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>j,frontMatter:()=>o,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"kurs-owasp/testowanie-podatnosci/a03-injection-cwiczenie","title":"\ud83e\uddea 3.3.5 \u2013 Praktyczne \u0107wiczenie: Testowanie i mitigacja","description":"\ud83c\udfaf Cel \u0107wiczenia","source":"@site/docs/kurs-owasp/03-testowanie-podatnosci/a03-injection-cwiczenie.md","sourceDirName":"kurs-owasp/03-testowanie-podatnosci","slug":"/kurs-owasp/testowanie-podatnosci/a03-injection-cwiczenie","permalink":"/docs/kurs-owasp/testowanie-podatnosci/a03-injection-cwiczenie","draft":false,"unlisted":false,"editUrl":"https://github.com/przemyslvw/my-page/edit/master/docs/kurs-owasp/03-testowanie-podatnosci/a03-injection-cwiczenie.md","tags":[],"version":"current","sidebarPosition":15,"frontMatter":{"id":"a03-injection-cwiczenie","title":"\ud83e\uddea 3.3.5 \u2013 Praktyczne \u0107wiczenie: Testowanie i mitigacja","sidebar_position":15},"sidebar":"tutorialSidebar","previous":{"title":"\ud83e\uddf0 3.3.4 \u2013 Narz\u0119dzia do testowania","permalink":"/docs/kurs-owasp/testowanie-podatnosci/a03-injection-narzedzia"},"next":{"title":"Opis podatno\u015bci i jej wp\u0142yw","permalink":"/docs/kurs-owasp/testowanie-podatnosci/a04-insecure-design-opis"}}');var s=i(74848),c=i(28453);const o={id:"a03-injection-cwiczenie",title:"\ud83e\uddea 3.3.5 \u2013 Praktyczne \u0107wiczenie: Testowanie i mitigacja",sidebar_position:15},l=void 0,r={},d=[{value:"\ud83c\udfaf Cel \u0107wiczenia",id:"-cel-\u0107wiczenia",level:2},{value:"\ud83e\uddea Scenariusz testowy 1: SQL Injection (klasyczny)",id:"-scenariusz-testowy-1-sql-injection-klasyczny",level:2},{value:"Krok 1: Prze\u015blij klasyczne payloady w polu loginu lub parametrze URL:",id:"krok-1-prze\u015blij-klasyczne-payloady-w-polu-loginu-lub-parametrze-url",level:3},{value:"Krok 2: Potwierdzenie podatno\u015bci",id:"krok-2-potwierdzenie-podatno\u015bci",level:3},{value:"Mitigacja",id:"mitigacja",level:3},{value:"\ud83e\uddea Scenariusz testowy 2: Command Injection",id:"-scenariusz-testowy-2-command-injection",level:2},{value:"Krok 1: Wprowad\u017a warto\u015b\u0107:",id:"krok-1-wprowad\u017a-warto\u015b\u0107",level:3},{value:"Mitigacja",id:"mitigacja-1",level:3},{value:"\ud83d\udee0\ufe0f Zadanie: testuj formularz z back-endem C#",id:"\ufe0f-zadanie-testuj-formularz-z-back-endem-c",level:2},{value:"Krok 1: Spr\xf3buj wywo\u0142a\u0107:",id:"krok-1-spr\xf3buj-wywo\u0142a\u0107",level:3},{value:"Krok 2: Przejrzyj backend aplikacji",id:"krok-2-przejrzyj-backend-aplikacji",level:3},{value:"\ud83d\udccb Zadania do wykonania",id:"-zadania-do-wykonania",level:2},{value:"\ud83e\udde0 Dodatkowe scenariusze",id:"-dodatkowe-scenariusze",level:2},{value:"1. \ud83e\uddec NoSQL Injection (MongoDB)",id:"1--nosql-injection-mongodb",level:3},{value:"2. \ud83e\uddfe LDAP Injection",id:"2--ldap-injection",level:3},{value:"3. \ud83e\uddea eval() / exec() w backendzie Node.js lub Python",id:"3--eval--exec-w-backendzie-nodejs-lub-python",level:3},{value:"Node.js",id:"nodejs",level:4},{value:"Python",id:"python",level:4},{value:"4. \ud83d\udcbb .NET \u2013 dynamiczna kompilacja i wykonywanie kodu",id:"4--net--dynamiczna-kompilacja-i-wykonywanie-kodu",level:3}];function t(e){const n={code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"-cel-\u0107wiczenia",children:"\ud83c\udfaf Cel \u0107wiczenia"}),"\n",(0,s.jsxs)(n.p,{children:["Nauczy\u0107 si\u0119 identyfikowa\u0107, wykorzystywa\u0107 i \u0142agodzi\u0107 podatno\u015bci ",(0,s.jsx)(n.strong,{children:"Injection"}),", w szczeg\xf3lno\u015bci ",(0,s.jsx)(n.strong,{children:"SQL Injection"})," i ",(0,s.jsx)(n.strong,{children:"Command Injection"}),", w realistycznym \u015brodowisku."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-scenariusz-testowy-1-sql-injection-klasyczny",children:"\ud83e\uddea Scenariusz testowy 1: SQL Injection (klasyczny)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Aplikacja:"})," Formularz logowania lub wyszukiwania w aplikacji webowej (np. DVWA, Juice Shop, testowa aplikacja ASP.NET/PHP)"]}),"\n",(0,s.jsx)(n.h3,{id:"krok-1-prze\u015blij-klasyczne-payloady-w-polu-loginu-lub-parametrze-url",children:"Krok 1: Prze\u015blij klasyczne payloady w polu loginu lub parametrze URL:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"admin' --\n' OR '1'='1\n1' OR 1=1 --\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u27a1\ufe0f Je\u015bli widzisz dane innych u\u017cytkownik\xf3w lub mo\u017cesz si\u0119 zalogowa\u0107 bez has\u0142a \u2013 luka potwierdzona."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"krok-2-potwierdzenie-podatno\u015bci",children:"Krok 2: Potwierdzenie podatno\u015bci"}),"\n",(0,s.jsxs)(n.p,{children:["U\u017cyj ",(0,s.jsx)(n.code,{children:"sqlmap"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'sqlmap -u "http://localhost/app.php?id=1" --dbs\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u2705 sqlmap wyka\u017ce list\u0119 dost\u0119pnych baz danych."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"mitigacja",children:"Mitigacja"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Stosuj ",(0,s.jsx)(n.strong,{children:"parametryzowane zapytania"})," (np. ",(0,s.jsx)(n.code,{children:"@param"}),", ",(0,s.jsx)(n.code,{children:"$1"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:["Unikaj \u0142\u0105czenia danych wej\u015bciowych z SQL w ",(0,s.jsx)(n.code,{children:"+"})," lub ",(0,s.jsx)(n.code,{children:"concat"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-scenariusz-testowy-2-command-injection",children:"\ud83e\uddea Scenariusz testowy 2: Command Injection"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Aplikacja:"})," Formularz pingowania IP w panelu admina"]}),"\n",(0,s.jsx)(n.h3,{id:"krok-1-wprowad\u017a-warto\u015b\u0107",children:"Krok 1: Wprowad\u017a warto\u015b\u0107:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"127.0.0.1; whoami\n"})}),"\n",(0,s.jsx)(n.p,{children:"lub"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"127.0.0.1 && id\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u27a1\ufe0f Je\u015bli wynik polecenia pojawi si\u0119 w odpowiedzi \u2013 luka potwierdzona."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"mitigacja-1",children:"Mitigacja"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Nigdy nie wykonuj komend systemowych na podstawie danych u\u017cytkownika."}),"\n",(0,s.jsx)(n.li,{children:"Stosuj whitelisty dopuszczalnych warto\u015bci."}),"\n",(0,s.jsxs)(n.li,{children:["U\u017cywaj bezpiecznych wrapper\xf3w (np. ",(0,s.jsx)(n.code,{children:"ProcessBuilder"}),", ",(0,s.jsx)(n.code,{children:"execFile"})," zamiast ",(0,s.jsx)(n.code,{children:"exec"}),")."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-zadanie-testuj-formularz-z-back-endem-c",children:"\ud83d\udee0\ufe0f Zadanie: testuj formularz z back-endem C#"}),"\n",(0,s.jsx)(n.h3,{id:"krok-1-spr\xf3buj-wywo\u0142a\u0107",children:"Krok 1: Spr\xf3buj wywo\u0142a\u0107:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"' OR 1=1 --\n"})}),"\n",(0,s.jsx)(n.p,{children:"w polu loginu lub zapytaniu GET."}),"\n",(0,s.jsx)(n.h3,{id:"krok-2-przejrzyj-backend-aplikacji",children:"Krok 2: Przejrzyj backend aplikacji"}),"\n",(0,s.jsx)(n.p,{children:"Znajd\u017a zapytania SQL konstruowane jako:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'"SELECT * FROM Users WHERE Username = \'" + username + "\'"\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u27a1\ufe0f Zamie\u0144 na:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'new SqlCommand("SELECT * FROM Users WHERE Username = @username", connection)\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-zadania-do-wykonania",children:"\ud83d\udccb Zadania do wykonania"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Zidentyfikuj co najmniej jedn\u0105 luk\u0119 Injection (SQLi lub Command)."]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Udokumentuj testy i payloady."]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Przedstaw rekomendacj\u0119 mitigacji."]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Uwzgl\u0119dnij testy w raporcie ko\u0144cowym."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-dodatkowe-scenariusze",children:"\ud83e\udde0 Dodatkowe scenariusze"}),"\n",(0,s.jsx)(n.h3,{id:"1--nosql-injection-mongodb",children:"1. \ud83e\uddec NoSQL Injection (MongoDB)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Aplikacja:"})," REST API z MongoDB"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Payloady:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{ "username": { "$ne": null }, "password": { "$ne": null } }\n'})}),"\n",(0,s.jsx)(n.p,{children:"lub (w URL):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"username[$ne]=1&password[$ne]=1\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u27a1\ufe0f Je\u015bli logowanie si\u0119 powiedzie bez poprawnych danych, aplikacja jest podatna."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Mitigacja:"})," Waliduj schemat JSON, u\u017cywaj ORMy (np. Mongoose z w\u0142\u0105czon\u0105 walidacj\u0105)."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"2--ldap-injection",children:"2. \ud83e\uddfe LDAP Injection"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Payload:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"*)(uid=*))(|(uid=*\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Scenariusz:"})," Je\u015bli u\u017cytkownik mo\u017ce zalogowa\u0107 si\u0119 przy u\u017cyciu takiego loginu, aplikacja mo\u017ce by\u0107 podatna."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Mitigacja:"})," U\u017cywaj ",(0,s.jsx)(n.code,{children:"DirectorySearcher.Filter"})," z escapingiem znak\xf3w specjalnych. W .NET:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'string safeFilter = $"(uid={EscapeLdap(userInput)})";\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"3--eval--exec-w-backendzie-nodejs-lub-python",children:"3. \ud83e\uddea eval() / exec() w backendzie Node.js lub Python"}),"\n",(0,s.jsx)(n.h4,{id:"nodejs",children:"Node.js"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"eval(userInput); // \u274c RCE\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Mitigacja:"})," Nigdy nie u\u017cywaj ",(0,s.jsx)(n.code,{children:"eval()"})," do przetwarzania danych u\u017cytkownika. Stosuj ",(0,s.jsx)(n.code,{children:"JSON.parse"})," tylko po uprzedniej walidacji."]}),"\n",(0,s.jsx)(n.h4,{id:"python",children:"Python"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"exec(user_input)  # \u274c podatne\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Mitigacja:"})," Stosuj ",(0,s.jsx)(n.code,{children:"literal_eval"})," z ",(0,s.jsx)(n.code,{children:"ast"}),", waliduj wszystkie dane wej\u015bciowe."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"4--net--dynamiczna-kompilacja-i-wykonywanie-kodu",children:"4. \ud83d\udcbb .NET \u2013 dynamiczna kompilacja i wykonywanie kodu"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Przyk\u0142ad zagro\u017cenia:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"var result = CSharpScript.EvaluateAsync(userInput).Result;\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u27a1\ufe0f Umo\u017cliwia uruchomienie dowolnego kodu C# przez u\u017cytkownika \u2013 krytyczna luka."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Mitigacja:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Nigdy nie wykonuj kodu z danych u\u017cytkownika."}),"\n",(0,s.jsxs)(n.li,{children:["Je\u015bli musisz \u2013 u\u017cywaj sandbox\xf3w, np. z ",(0,s.jsx)(n.code,{children:"ScriptOptions"})," i whitelist\u0105 ",(0,s.jsx)(n.code,{children:"references"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["W kolejnym rozdziale: ",(0,s.jsx)(n.strong,{children:"3.4 \u2013 Insecure Design"})]})]})}function j(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}}}]);