<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚öîÔ∏è Krzy≈ºowiec vs Si≈Çy Z≈Ça</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Cinzel', serif;
            background: linear-gradient(45deg, #2c1810, #1a0f0a);
            overflow: hidden;
            height: 100vh;
            color: #fff;
        }
        
        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: 
                radial-gradient(circle at 20% 30%, rgba(139, 69, 19, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(75, 0, 0, 0.4) 0%, transparent 50%),
                linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f23 100%);
        }
        
        #startScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        #gameTitle {
            font-size: 4rem;
            font-weight: 700;
            color: #ffd700;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.8);
            margin-bottom: 2rem;
            text-align: center;
            animation: titleGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes titleGlow {
            from { text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.8), 0 0 20px rgba(255, 215, 0, 0.5); }
            to { text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.8), 0 0 30px rgba(255, 215, 0, 0.8); }
        }
        
        #startButton {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            font-weight: 600;
            padding: 15px 30px;
            background: linear-gradient(45deg, #8B4513, #A0522D);
            color: #fff;
            border: 3px solid #ffd700;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }
        
        #startButton:hover {
            background: linear-gradient(45deg, #A0522D, #CD853F);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
        }
        
        #gameUI {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .ui-element {
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 15px;
            margin: 5px 0;
            border-radius: 5px;
            border: 2px solid #ffd700;
        }
        
        #healthBar {
            width: 200px;
            height: 20px;
            background: #333;
            border: 2px solid #ffd700;
            border-radius: 10px;
            overflow: hidden;
        }
        
        #healthFill {
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ff6600, #ffaa00);
            transition: width 0.3s ease;
            width: 100%;
        }
        
        .entity {
            position: absolute;
            transition: transform 0.1s linear;
        }
        
        .projectile {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ff4444;
            border-radius: 50%;
            box-shadow: 0 0 10px #ff4444;
        }
        
        .explosion {
            position: absolute;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: radial-gradient(circle, #ff6600, #ff0000, transparent);
            animation: explode 0.5s ease-out forwards;
        }
        
        @keyframes explode {
            from { transform: scale(0); opacity: 1; }
            to { transform: scale(2); opacity: 0; }
        }
        
        .damage-text {
            position: absolute;
            color: #ff4444;
            font-weight: bold;
            font-size: 1.2rem;
            animation: damageFloat 1s ease-out forwards;
            pointer-events: none;
            z-index: 1000;
        }
        
        @keyframes damageFloat {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(-50px); opacity: 0; }
        }
        
        #gameOverScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        #gameOverTitle {
            font-size: 3rem;
            color: #ff4444;
            margin-bottom: 1rem;
        }
        
        #finalScore {
            font-size: 1.5rem;
            color: #ffd700;
            margin-bottom: 2rem;
        }
        
        .hidden {
            display: none !important;
        }
        
        /* Animacje dla postaci */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes blink {
            0%, 90% { fill: #ff0000; }
            95% { fill: #ffaa00; }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <!-- Ekran startowy -->
        <div id="startScreen">
            <h1 id="gameTitle">‚öîÔ∏è Krzy≈ºowiec vs Si≈Çy Z≈Ça</h1>
            <button id="startButton">Rozpocznij krucjatƒô</button>
        </div>
        
        <!-- UI gry -->
        <div id="gameUI" class="hidden">
            <div class="ui-element">
                <div>‚ù§Ô∏è Zdrowie:</div>
                <div id="healthBar">
                    <div id="healthFill"></div>
                </div>
            </div>
            <div class="ui-element">‚öîÔ∏è Punkty: <span id="score">0</span></div>
            <div class="ui-element">‚è±Ô∏è Czas: <span id="time">0</span>s</div>
            <div class="ui-element">üî• Poziom: <span id="level">1</span></div>
        </div>
        
        <!-- Ekran ko≈Ñca gry -->
        <div id="gameOverScreen">
            <h2 id="gameOverTitle">Twoja krucjata dobieg≈Ça ko≈Ñca!</h2>
            <div id="finalScore">Finalne punkty: 0</div>
            <button id="restartButton" class="ui-element" style="cursor: pointer;">Rozpocznij ponownie</button>
        </div>
        
        <!-- Obszar gry -->
        <div id="gameArea"></div>
    </div>

    <script>
        // Definicje SVG dla wszystkich postaci
        const SVG_DEFINITIONS = {
            crusader: `
                <svg width="40" height="40" viewBox="0 0 40 40">
                    <!-- Cia≈Ço -->
                    <rect x="15" y="20" width="10" height="15" fill="#8B4513" stroke="#654321" stroke-width="1"/>
                    <!-- G≈Çowa -->
                    <circle cx="20" cy="12" r="6" fill="#FFDBAC" stroke="#D2B48C" stroke-width="1"/>
                    <!-- He≈Çm -->
                    <path d="M14 8 L26 8 L26 12 L24 14 L16 14 Z" fill="#C0C0C0" stroke="#808080" stroke-width="1"/>
                    <!-- Krzy≈º na he≈Çmie -->
                    <rect x="19" y="6" width="2" height="6" fill="#FF0000"/>
                    <rect x="17" y="8" width="6" height="2" fill="#FF0000"/>
                    <!-- Rƒôce -->
                    <rect x="12" y="22" width="4" height="8" fill="#FFDBAC"/>
                    <rect x="24" y="22" width="4" height="8" fill="#FFDBAC"/>
                    <!-- Nogi -->
                    <rect x="16" y="35" width="3" height="5" fill="#654321"/>
                    <rect x="21" y="35" width="3" height="5" fill="#654321"/>
                    <!-- Miecz -->
                    <rect x="28" y="18" width="2" height="12" fill="#C0C0C0"/>
                    <rect x="27" y="16" width="4" height="2" fill="#8B4513"/>
                    <!-- Aura -->
                    <circle cx="20" cy="20" r="18" fill="none" stroke="#FFD700" stroke-width="1" opacity="0.3"/>
                </svg>
            `,
            
            sinner: `
                <svg width="30" height="30" viewBox="0 0 30 30">
                    <!-- Cia≈Ço -->
                    <ellipse cx="15" cy="20" rx="8" ry="6" fill="#696969" stroke="#2F2F2F" stroke-width="1"/>
                    <!-- G≈Çowa -->
                    <circle cx="15" cy="12" r="5" fill="#808080" stroke="#2F2F2F" stroke-width="1"/>
                    <!-- Oczy z≈Çe -->
                    <circle cx="13" cy="10" r="1" fill="#FF0000"/>
                    <circle cx="17" cy="10" r="1" fill="#FF0000"/>
                    <!-- Usta -->
                    <path d="M12 14 Q15 16 18 14" stroke="#000" stroke-width="1" fill="none"/>
                    <!-- Rƒôce -->
                    <ellipse cx="8" cy="18" rx="2" ry="4" fill="#696969"/>
                    <ellipse cx="22" cy="18" rx="2" ry="4" fill="#696969"/>
                </svg>
            `,
            
            demon: `
                <svg width="35" height="35" viewBox="0 0 35 35">
                    <!-- Cia≈Ço -->
                    <ellipse cx="17.5" cy="22" rx="10" ry="8" fill="#8B0000" stroke="#4B0000" stroke-width="1"/>
                    <!-- G≈Çowa -->
                    <circle cx="17.5" cy="13" r="6" fill="#CD0000" stroke="#8B0000" stroke-width="1"/>
                    <!-- Rogi -->
                    <polygon points="12,8 14,4 16,8" fill="#2F2F2F"/>
                    <polygon points="19,8 21,4 23,8" fill="#2F2F2F"/>
                    <!-- Oczy migajƒÖce -->
                    <circle cx="15" cy="11" r="1.5" fill="#FFFF00" class="blink-eyes">
                        <animate attributeName="fill" values="#FFFF00;#FF0000;#FFFF00" dur="0.5s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="20" cy="11" r="1.5" fill="#FFFF00" class="blink-eyes">
                        <animate attributeName="fill" values="#FFFF00;#FF0000;#FFFF00" dur="0.5s" repeatCount="indefinite"/>
                    </circle>
                    <!-- Pazury -->
                    <polygon points="7,20 5,18 9,22" fill="#2F2F2F"/>
                    <polygon points="28,20 30,18 26,22" fill="#2F2F2F"/>
                </svg>
            `,
            
            witch: `
                <svg width="32" height="40" viewBox="0 0 32 40">
                    <!-- Peleryna -->
                    <ellipse cx="16" cy="25" rx="12" ry="10" fill="#4B0082" stroke="#2F0052" stroke-width="1"/>
                    <!-- Cia≈Ço -->
                    <ellipse cx="16" cy="20" rx="6" ry="8" fill="#2F2F2F" stroke="#000" stroke-width="1"/>
                    <!-- G≈Çowa -->
                    <circle cx="16" cy="12" r="5" fill="#90EE90" stroke="#228B22" stroke-width="1"/>
                    <!-- Kapelusz -->
                    <polygon points="11,8 21,8 18,2 14,2" fill="#2F2F2F"/>
                    <ellipse cx="16" cy="8" rx="7" ry="2" fill="#2F2F2F"/>
                    <!-- Oczy -->
                    <circle cx="14" cy="10" r="1" fill="#FF0000"/>
                    <circle cx="18" cy="10" r="1" fill="#FF0000"/>
                    <!-- R√≥≈ºd≈ºka -->
                    <rect x="25" y="15" width="1" height="8" fill="#8B4513"/>
                    <circle cx="25.5" cy="14" r="2" fill="#800080"/>
                    <!-- Aura lewitacji -->
                    <ellipse cx="16" cy="35" rx="10" ry="3" fill="none" stroke="#4B0082" stroke-width="1" opacity="0.5"/>
                </svg>
            `,
            
            fallenKnight: `
                <svg width="38" height="42" viewBox="0 0 38 42">
                    <!-- Cia≈Ço opancerzone -->
                    <rect x="14" y="20" width="10" height="18" fill="#2F2F2F" stroke="#000" stroke-width="1"/>
                    <!-- Naramienniki -->
                    <rect x="10" y="18" width="6" height="8" fill="#2F2F2F"/>
                    <rect x="22" y="18" width="6" height="8" fill="#2F2F2F"/>
                    <!-- He≈Çm -->
                    <rect x="13" y="8" width="12" height="12" fill="#2F2F2F" stroke="#000" stroke-width="1"/>
                    <!-- Szpara na oczy -->
                    <rect x="15" y="12" width="8" height="2" fill="#FF0000"/>
                    <!-- Tarcza -->
                    <ellipse cx="8" cy="22" rx="4" ry="6" fill="#4B0000" stroke="#8B0000" stroke-width="1"/>
                    <rect x="6" y="20" width="4" height="1" fill="#FFD700"/>
                    <rect x="7" y="19" width="2" height="3" fill="#FFD700"/>
                    <!-- Top√≥r -->
                    <rect x="30" y="15" width="2" height="12" fill="#8B4513"/>
                    <polygon points="28,12 32,12 35,15 32,18 28,18" fill="#C0C0C0"/>
                    <!-- Nogi -->
                    <rect x="15" y="38" width="3" height="4" fill="#2F2F2F"/>
                    <rect x="20" y="38" width="3" height="4" fill="#2F2F2F"/>
                </svg>
            `,
            
            heretic: `
                <svg width="35" height="45" viewBox="0 0 35 45">
                    <!-- Peleryna lewitujƒÖca -->
                    <ellipse cx="17.5" cy="30" rx="14" ry="12" fill="#800080" stroke="#4B0082" stroke-width="1" opacity="0.8"/>
                    <!-- Cia≈Ço -->
                    <ellipse cx="17.5" cy="22" rx="7" ry="10" fill="#2F2F2F" stroke="#000" stroke-width="1"/>
                    <!-- G≈Çowa -->
                    <circle cx="17.5" cy="12" r="5" fill="#FFDBAC" stroke="#D2B48C" stroke-width="1"/>
                    <!-- Kaptur -->
                    <path d="M12 8 Q17.5 5 23 8 Q23 12 17.5 14 Q12 12 12 8" fill="#4B0082"/>
                    <!-- Oczy ≈õwiecƒÖce -->
                    <circle cx="15" cy="10" r="1.5" fill="#00FFFF">
                        <animate attributeName="r" values="1.5;2;1.5" dur="1s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="20" cy="10" r="1.5" fill="#00FFFF">
                        <animate attributeName="r" values="1.5;2;1.5" dur="1s" repeatCount="indefinite"/>
                    </circle>
                    <!-- Rƒôce mistyczne -->
                    <circle cx="10" cy="20" r="3" fill="#800080" opacity="0.7"/>
                    <circle cx="25" cy="20" r="3" fill="#800080" opacity="0.7"/>
                    <!-- Efekt teleportacji -->
                    <circle cx="17.5" cy="40" r="12" fill="none" stroke="#800080" stroke-width="2" opacity="0.3"/>
                </svg>
            `,
            
            hellBeast: `
                <svg width="50" height="45" viewBox="0 0 50 45">
                    <!-- Cia≈Ço bestii -->
                    <ellipse cx="25" cy="30" rx="18" ry="12" fill="#8B0000" stroke="#4B0000" stroke-width="2"/>
                    <!-- G≈Çowa -->
                    <ellipse cx="25" cy="18" rx="12" ry="8" fill="#CD0000" stroke="#8B0000" stroke-width="2"/>
                    <!-- Rogi du≈ºe -->
                    <polygon points="15,12 12,5 18,10" fill="#2F2F2F"/>
                    <polygon points="35,12 38,5 32,10" fill="#2F2F2F"/>
                    <!-- Oczy piekielne -->
                    <circle cx="21" cy="16" r="2" fill="#FFFF00"/>
                    <circle cx="29" cy="16" r="2" fill="#FFFF00"/>
                    <!-- Pysk -->
                    <ellipse cx="25" cy="22" rx="6" ry="3" fill="#000"/>
                    <!-- K≈Çy -->
                    <polygon points="22,22 20,26 24,24" fill="#FFF"/>
                    <polygon points="28,22 30,26 26,24" fill="#FFF"/>
                    <!-- Ogie≈Ñ z pyska -->
                    <ellipse cx="25" cy="26" rx="4" ry="2" fill="#FF6600" opacity="0.8">
                        <animate attributeName="rx" values="4;6;4" dur="0.5s" repeatCount="indefinite"/>
                    </ellipse>
                    <!-- ≈Åapy -->
                    <ellipse cx="10" cy="35" rx="4" ry="6" fill="#8B0000"/>
                    <ellipse cx="40" cy="35" rx="4" ry="6" fill="#8B0000"/>
                    <!-- Pazury -->
                    <polygon points="8,38 6,42 10,40" fill="#2F2F2F"/>
                    <polygon points="42,38 44,42 40,40" fill="#2F2F2F"/>
                </svg>
            `,
            
            doom: `
                <svg width="25" height="25" viewBox="0 0 25 25">
                    <!-- Cia≈Ço pulsujƒÖce -->
                    <circle cx="12.5" cy="12.5" r="10" fill="#8B0000" stroke="#FF0000" stroke-width="2">
                        <animate attributeName="r" values="10;12;10" dur="0.8s" repeatCount="indefinite"/>
                        <animate attributeName="fill" values="#8B0000;#FF0000;#8B0000" dur="0.8s" repeatCount="indefinite"/>
                    </circle>
                    <!-- ≈örodek pulsujƒÖcy -->
                    <circle cx="12.5" cy="12.5" r="5" fill="#FF6600">
                        <animate attributeName="r" values="5;7;5" dur="0.6s" repeatCount="indefinite"/>
                    </circle>
                    <!-- Centrum -->
                    <circle cx="12.5" cy="12.5" r="2" fill="#FFFF00">
                        <animate attributeName="r" values="2;3;2" dur="0.4s" repeatCount="indefinite"/>
                    </circle>
                    <!-- Iskry -->
                    <circle cx="8" cy="8" r="1" fill="#FF6600" opacity="0.8">
                        <animate attributeName="opacity" values="0.8;0;0.8" dur="0.3s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="17" cy="8" r="1" fill="#FF6600" opacity="0.8">
                        <animate attributeName="opacity" values="0;0.8;0" dur="0.3s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="8" cy="17" r="1" fill="#FF6600" opacity="0.8">
                        <animate attributeName="opacity" values="0.8;0;0.8" dur="0.3s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="17" cy="17" r="1" fill="#FF6600" opacity="0.8">
                        <animate attributeName="opacity" values="0;0.8;0" dur="0.3s" repeatCount="indefinite"/>
                    </circle>
                </svg>
            `,
            
            crossAttack: `
                <svg width="30" height="30" viewBox="0 0 30 30">
                    <g transform="rotate(45 15 15)">
                        <rect x="13" y="5" width="4" height="20" fill="#FFD700" opacity="0.9">
                            <animate attributeName="opacity" values="0.9;0.3;0.9" dur="0.3s" repeatCount="indefinite"/>
                        </rect>
                        <rect x="5" y="13" width="20" height="4" fill="#FFD700" opacity="0.9">
                            <animate attributeName="opacity" values="0.9;0.3;0.9" dur="0.3s" repeatCount="indefinite"/>
                        </rect>
                    </g>
                    <circle cx="15" cy="15" r="12" fill="none" stroke="#FFD700" stroke-width="2" opacity="0.5">
                        <animate attributeName="r" values="12;15;12" dur="0.3s" repeatCount="indefinite"/>
                    </circle>
                </svg>
            `,
            
            witchProjectile: `
                <svg width="12" height="12" viewBox="0 0 12 12">
                    <circle cx="6" cy="6" r="5" fill="#800080" stroke="#4B0082" stroke-width="1">
                        <animate attributeName="r" values="5;6;5" dur="0.4s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="6" cy="6" r="2" fill="#FF00FF">
                        <animate attributeName="r" values="2;3;2" dur="0.3s" repeatCount="indefinite"/>
                    </circle>
                </svg>
            `
        };

        // Stan gry
        let gameState = {
            isRunning: false,
            isPaused: false,
            player: {
                x: window.innerWidth / 2,
                y: window.innerHeight / 2,
                health: 100,
                maxHealth: 100,
                element: null
            },
            enemies: [],
            projectiles: [],
            score: 0,
            time: 0,
            level: 1,
            lastAttack: 0,
            keys: {}
        };

        // Typy wrog√≥w z ich w≈Ça≈õciwo≈õciami
        const ENEMY_TYPES = {
            sinner: {
                health: 30,
                speed: 1,
                damage: 15,
                size: 30,
                points: 10,
                color: '#696969',
                behavior: 'random',
                svg: 'sinner'
            },
            demon: {
                health: 50,
                speed: 2.5,
                damage: 25,
                size: 35,
                points: 25,
                color: '#8B0000',
                behavior: 'chase',
                svg: 'demon'
            },
            witch: {
                health: 40,
                speed: 0.8,
                damage: 20,
                size: 32,
                points: 30,
                color: '#4B0082',
                behavior: 'float_shoot',
                svg: 'witch',
                lastShot: 0,
                shootInterval: 3000
            },
            fallenKnight: {
                health: 80,
                speed: 0.5,
                damage: 35,
                size: 38,
                points: 40,
                color: '#2F2F2F',
                behavior: 'slow_chase',
                svg: 'fallenKnight'
            },
            heretic: {
                health: 60,
                speed: 1.5,
                damage: 30,
                size: 35,
                points: 50,
                color: '#800080',
                behavior: 'teleport',
                svg: 'heretic',
                lastTeleport: 0,
                teleportInterval: 5000
            },
            hellBeast: {
                health: 150,
                speed: 1,
                damage: 50,
                size: 50,
                points: 100,
                color: '#8B0000',
                behavior: 'boss',
                svg: 'hellBeast'
            },
            doom: {
                health: 20,
                speed: 2,
                damage: 60,
                size: 25,
                points: 35,
                color: '#8B0000',
                behavior: 'suicide',
                svg: 'doom'
            }
        };

        // Inicjalizacja gry
        function initGame() {
            const startScreen = document.getElementById('startScreen');
            const gameUI = document.getElementById('gameUI');
            const gameArea = document.getElementById('gameArea');
            
            // Stw√≥rz gracza
            createPlayer();
            
            // Ukryj ekran startowy, poka≈º UI
            startScreen.classList.add('hidden');
            gameUI.classList.remove('hidden');
            
            // Rozpocznij grƒô
            gameState.isRunning = true;
            gameState.time = 0;
            gameState.score = 0;
            gameState.level = 1;
            
            // Rozpocznij pƒôtle gry
            gameLoop();
            spawnEnemies();
            
            // Event listenery dla sterowania
            setupControls();
        }

        // Tworzenie gracza
        function createPlayer() {
            const gameArea = document.getElementById('gameArea');
            const playerElement = document.createElement('div');
            playerElement.className = 'entity';
            playerElement.id = 'player';
            playerElement.innerHTML = SVG_DEFINITIONS.crusader;
            playerElement.style.left = gameState.player.x + 'px';
            playerElement.style.top = gameState.player.y + 'px';
            gameArea.appendChild(playerElement);
            gameState.player.element = playerElement;
        }

        // Konfiguracja sterowania
        function setupControls() {
            document.addEventListener('keydown', (e) => {
                gameState.keys[e.key.toLowerCase()] = true;
            });
            
            document.addEventListener('keyup', (e) => {
                gameState.keys[e.key.toLowerCase()] = false;
            });
        }

        // G≈Ç√≥wna pƒôtla gry
        function gameLoop() {
            if (!gameState.isRunning) return;
            
            updatePlayer();
            updateEnemies();
            updateProjectiles();
            checkCollisions();
            handleAttacks();
            updateUI();
            
            requestAnimationFrame(gameLoop);
        }

        // Aktualizacja gracza
        function updatePlayer() {
            const speed = 4;
            let newX = gameState.player.x;
            let newY = gameState.player.y;
            
            // Sterowanie WASD
            if (gameState.keys['w'] || gameState.keys['arrowup']) newY -= speed;
            if (gameState.keys['s'] || gameState.keys['arrowdown']) newY += speed;
            if (gameState.keys['a'] || gameState.keys['arrowleft']) newX -= speed;
            if (gameState.keys['d'] || gameState.keys['arrowright']) newX += speed;
            
            // Ograniczenia ekranu
            newX = Math.max(20, Math.min(window.innerWidth - 60, newX));
            newY = Math.max(20, Math.min(window.innerHeight - 60, newY));
            
            gameState.player.x = newX;
            gameState.player.y = newY;
            
            // Aktualizuj pozycjƒô elementu
            if (gameState.player.element) {
                gameState.player.element.style.left = newX + 'px';
                gameState.player.element.style.top = newY + 'px';
            }
        }

        // Tworzenie wroga
        function createEnemy(type, x, y) {
            const enemyData = ENEMY_TYPES[type];
            const gameArea = document.getElementById('gameArea');
            
            const enemy = {
                type: type,
                x: x,
                y: y,
                health: enemyData.health,
                maxHealth: enemyData.health,
                speed: enemyData.speed,
                damage: enemyData.damage,
                size: enemyData.size,
                points: enemyData.points,
                behavior: enemyData.behavior,
                lastAction: Date.now(),
                element: null,
                ...enemyData
            };
            
            const enemyElement = document.createElement('div');
            enemyElement.className = 'entity enemy';
            enemyElement.innerHTML = SVG_DEFINITIONS[enemyData.svg];
            enemyElement.style.left = x + 'px';
            enemyElement.style.top = y + 'px';
            gameArea.appendChild(enemyElement);
            
            enemy.element = enemyElement;
            gameState.enemies.push(enemy);
            
            return enemy;
        }

        // Spawnowanie wrog√≥w
        function spawnEnemies() {
            if (!gameState.isRunning) return;
            
            const spawnTypes = ['sinner', 'demon'];
            
            // Dodaj wiƒôcej typ√≥w wrog√≥w w zale≈ºno≈õci od poziomu
            if (gameState.level >= 2) spawnTypes.push('witch');
            if (gameState.level >= 3) spawnTypes.push('fallenKnight');
            if (gameState.level >= 4) spawnTypes.push('heretic');
            if (gameState.level >= 5) spawnTypes.push('doom');
            if (gameState.level >= 6) spawnTypes.push('hellBeast');
            
            const spawnCount = Math.min(1 + Math.floor(gameState.level / 2), 5);
            
            for (let i = 0; i < spawnCount; i++) {
                const type = spawnTypes[Math.floor(Math.random() * spawnTypes.length)];
                const side = Math.floor(Math.random() * 4);
                let x, y;
                
                switch (side) {
                    case 0: // Top
                        x = Math.random() * window.innerWidth;
                        y = -50;
                        break;
                    case 1: // Right
                        x = window.innerWidth + 50;
                        y = Math.random() * window.innerHeight;
                        break;
                    case 2: // Bottom
                        x = Math.random() * window.innerWidth;
                        y = window.innerHeight + 50;
                        break;
                    case 3: // Left
                        x = -50;
                        y = Math.random() * window.innerHeight;
                        break;
                }
                
                createEnemy(type, x, y);
            }
            
            // Nastƒôpne spawn
            const spawnInterval = Math.max(2000 - (gameState.level * 100), 800);
            setTimeout(spawnEnemies, spawnInterval);
        }

        // Aktualizacja wrog√≥w
        function updateEnemies() {
            const currentTime = Date.now();
            
            gameState.enemies.forEach((enemy, index) => {
                if (!enemy.element) return;
                
                // AI behavior
                switch (enemy.behavior) {
                    case 'random':
                        moveRandomly(enemy);
                        break;
                    case 'chase':
                        chasePlayer(enemy);
                        break;
                    case 'float_shoot':
                        floatAndShoot(enemy, currentTime);
                        break;
                    case 'slow_chase':
                        chasePlayer(enemy);
                        break;
                    case 'teleport':
                        teleportBehavior(enemy, currentTime);
                        break;
                    case 'boss':
                        bossBehavior(enemy);
                        break;
                    case 'suicide':
                        suicideBehavior(enemy);
                        break;
                }
                
                // Aktualizuj pozycjƒô elementu
                enemy.element.style.left = enemy.x + 'px';
                enemy.element.style.top = enemy.y + 'px';
            });
        }

        // Zachowania wrog√≥w
        function moveRandomly(enemy) {
            if (Math.random() < 0.1) {
                const angle = Math.random() * Math.PI * 2;
                enemy.x += Math.cos(angle) * enemy.speed;
                enemy.y += Math.sin(angle) * enemy.speed;
            }
        }

        function chasePlayer(enemy) {
            const dx = gameState.player.x - enemy.x;
            const dy = gameState.player.y - enemy.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance > 0) {
                enemy.x += (dx / distance) * enemy.speed;
                enemy.y += (dy / distance) * enemy.speed;
            }
        }

        function floatAndShoot(enemy, currentTime) {
            // Lewitacja
            enemy.y += Math.sin(currentTime * 0.002) * 0.5;
            
            // Strzelanie
            if (currentTime - enemy.lastShot > enemy.shootInterval) {
                shootProjectile(enemy.x, enemy.y, gameState.player.x, gameState.player.y, 'witch');
                enemy.lastShot = currentTime;
            }
            
            // Delikatne podƒÖ≈ºanie za graczem
            const dx = gameState.player.x - enemy.x;
            const dy = gameState.player.y - enemy.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance > 200) {
                enemy.x += (dx / distance) * enemy.speed * 0.5;
                enemy.y += (dy / distance) * enemy.speed * 0.5;
            }
        }

        function teleportBehavior(enemy, currentTime) {
            if (currentTime - enemy.lastTeleport > enemy.teleportInterval) {
                // Teleportacja do losowego miejsca blisko gracza
                const angle = Math.random() * Math.PI * 2;
                const distance = 100 + Math.random() * 150;
                enemy.x = gameState.player.x + Math.cos(angle) * distance;
                enemy.y = gameState.player.y + Math.sin(angle) * distance;
                
                // Ograniczenia ekranu
                enemy.x = Math.max(50, Math.min(window.innerWidth - 50, enemy.x));
                enemy.y = Math.max(50, Math.min(window.innerHeight - 50, enemy.y));
                
                enemy.lastTeleport = currentTime;
                
                // Efekt teleportacji
                createEffect('teleport', enemy.x, enemy.y);
            } else {
                // Normalne podƒÖ≈ºanie
                chasePlayer(enemy);
            }
        }

        function bossBehavior(enemy) {
            chasePlayer(enemy);
            
            // Boss mo≈ºe oddychaƒá ogniem
            if (Math.random() < 0.005) {
                for (let i = 0; i < 3; i++) {
                    const angle = Math.atan2(gameState.player.y - enemy.y, gameState.player.x - enemy.x) + (Math.random() - 0.5) * 0.5;
                    shootProjectile(enemy.x, enemy.y, 
                        enemy.x + Math.cos(angle) * 100, 
                        enemy.y + Math.sin(angle) * 100, 'hellfire');
                }
            }
        }

        function suicideBehavior(enemy) {
            // Szybkie podƒÖ≈ºanie za graczem
            const dx = gameState.player.x - enemy.x;
            const dy = gameState.player.y - enemy.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance > 0) {
                enemy.x += (dx / distance) * enemy.speed * 1.5;
                enemy.y += (dy / distance) * enemy.speed * 1.5;
            }
            
            // Eksplozja przy dotyku gracza
            if (distance < 30) {
                explodeEnemy(enemy);
                damagePlayer(enemy.damage);
            }
        }

        // Strzelanie pocisk√≥w
        function shootProjectile(fromX, fromY, toX, toY, type) {
            const projectile = {
                x: fromX,
                y: fromY,
                targetX: toX,
                targetY: toY,
                speed: 3,
                damage: 20,
                type: type,
                element: null
            };
            
            const dx = toX - fromX;
            const dy = toY - fromY;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            projectile.vx = (dx / distance) * projectile.speed;
            projectile.vy = (dy / distance) * projectile.speed;
            
            const gameArea = document.getElementById('gameArea');
            const projectileElement = document.createElement('div');
            projectileElement.className = 'projectile';
            
            if (type === 'witch') {
                projectileElement.innerHTML = SVG_DEFINITIONS.witchProjectile;
            } else {
                projectileElement.style.background = type === 'hellfire' ? '#ff6600' : '#ff4444';
            }
            
            projectileElement.style.left = fromX + 'px';
            projectileElement.style.top = fromY + 'px';
            gameArea.appendChild(projectileElement);
            
            projectile.element = projectileElement;
            gameState.projectiles.push(projectile);
        }

        // Aktualizacja pocisk√≥w
        function updateProjectiles() {
            gameState.projectiles.forEach((projectile, index) => {
                projectile.x += projectile.vx;
                projectile.y += projectile.vy;
                
                if (projectile.element) {
                    projectile.element.style.left = projectile.x + 'px';
                    projectile.element.style.top = projectile.y + 'px';
                }
                
                // Usu≈Ñ pociski poza ekranem
                if (projectile.x < -50 || projectile.x > window.innerWidth + 50 ||
                    projectile.y < -50 || projectile.y > window.innerHeight + 50) {
                    if (projectile.element) {
                        projectile.element.remove();
                    }
                    gameState.projectiles.splice(index, 1);
                }
            });
        }

        // Obs≈Çuga atak√≥w gracza
        function handleAttacks() {
            const currentTime = Date.now();
            if (currentTime - gameState.lastAttack > 500) { // Atak co p√≥≈Ç sekundy
                const nearestEnemy = findNearestEnemy();
                if (nearestEnemy) {
                    attackEnemy(nearestEnemy);
                    gameState.lastAttack = currentTime;
                }
            }
        }

        // Znajd≈∫ najbli≈ºszego wroga
        function findNearestEnemy() {
            let nearest = null;
            let minDistance = Infinity;
            
            gameState.enemies.forEach(enemy => {
                const dx = enemy.x - gameState.player.x;
                const dy = enemy.y - gameState.player.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < minDistance && distance < 200) { // Zasiƒôg ataku
                    minDistance = distance;
                    nearest = enemy;
                }
            });
            
            return nearest;
        }

        // Atak na wroga
        function attackEnemy(enemy) {
            const damage = 40;
            enemy.health -= damage;
            
            // Efekt ataku
            createAttackEffect(enemy.x, enemy.y);
            showDamageText(enemy.x, enemy.y, damage);
            
            if (enemy.health <= 0) {
                killEnemy(enemy);
            }
        }

        // Zabicie wroga
        function killEnemy(enemy) {
            gameState.score += enemy.points;
            
            // Usu≈Ñ z tablicy i DOM
            const index = gameState.enemies.indexOf(enemy);
            if (index > -1) {
                gameState.enemies.splice(index, 1);
            }
            
            if (enemy.element) {
                enemy.element.remove();
            }
            
            // Efekt ≈õmierci
            createEffect('death', enemy.x, enemy.y);
        }

        // Eksplozja wroga (dla suicide)
        function explodeEnemy(enemy) {
            createEffect('explosion', enemy.x, enemy.y);
            killEnemy(enemy);
        }

        // Sprawdzanie kolizji
        function checkCollisions() {
            // Kolizje gracz-wrogowie
            gameState.enemies.forEach(enemy => {
                const dx = enemy.x - gameState.player.x;
                const dy = enemy.y - gameState.player.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 25) {
                    damagePlayer(enemy.damage);
                    if (enemy.type === 'doom') {
                        explodeEnemy(enemy);
                    }
                }
            });
            
            // Kolizje gracz-pociski
            gameState.projectiles.forEach((projectile, index) => {
                const dx = projectile.x - gameState.player.x;
                const dy = projectile.y - gameState.player.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 20) {
                    damagePlayer(projectile.damage);
                    if (projectile.element) {
                        projectile.element.remove();
                    }
                    gameState.projectiles.splice(index, 1);
                }
            });
        }

        // Obra≈ºenia gracza
        function damagePlayer(damage) {
            gameState.player.health -= damage;
            showDamageText(gameState.player.x, gameState.player.y, damage, true);
            
            if (gameState.player.health <= 0) {
                gameOver();
            }
        }

        // Tworzenie efekt√≥w wizualnych
        function createAttackEffect(x, y) {
            const gameArea = document.getElementById('gameArea');
            const effect = document.createElement('div');
            effect.className = 'entity';
            effect.innerHTML = SVG_DEFINITIONS.crossAttack;
            effect.style.left = (x - 15) + 'px';
            effect.style.top = (y - 15) + 'px';
            effect.style.pointerEvents = 'none';
            gameArea.appendChild(effect);
            
            setTimeout(() => {
                effect.remove();
            }, 300);
        }

        function createEffect(type, x, y) {
            const gameArea = document.getElementById('gameArea');
            const effect = document.createElement('div');
            
            switch (type) {
                case 'explosion':
                    effect.className = 'explosion';
                    break;
                case 'teleport':
                    effect.innerHTML = '<div style="width: 40px; height: 40px; border: 2px solid #800080; border-radius: 50%; animation: pulse 0.5s ease-out;"></div>';
                    break;
                case 'death':
                    effect.innerHTML = '<div style="width: 20px; height: 20px; background: #ff6600; border-radius: 50%; animation: explode 0.5s ease-out forwards;"></div>';
                    break;
            }
            
            effect.style.position = 'absolute';
            effect.style.left = (x - 20) + 'px';
            effect.style.top = (y - 20) + 'px';
            effect.style.pointerEvents = 'none';
            gameArea.appendChild(effect);
            
            setTimeout(() => {
                effect.remove();
            }, 500);
        }

        // Pokazanie tekstu obra≈ºe≈Ñ
        function showDamageText(x, y, damage, isPlayer = false) {
            const gameArea = document.getElementById('gameArea');
            const damageText = document.createElement('div');
            damageText.className = 'damage-text';
            damageText.textContent = `-${damage}`;
            damageText.style.left = x + 'px';
            damageText.style.top = y + 'px';
            
            if (isPlayer) {
                damageText.style.color = '#ff0000';
                damageText.style.fontSize = '1.5rem';
            }
            
            gameArea.appendChild(damageText);
            
            setTimeout(() => {
                damageText.remove();
            }, 1000);
        }

        // Aktualizacja UI
        function updateUI() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('time').textContent = Math.floor(Date.now() / 1000) - Math.floor(gameState.time);
            document.getElementById('level').textContent = gameState.level;
            
            // Aktualizuj pasek zdrowia
            const healthPercentage = (gameState.player.health / gameState.player.maxHealth) * 100;
            document.getElementById('healthFill').style.width = healthPercentage + '%';
            
            // Aktualizuj poziom co 30 sekund
            const currentTime = Math.floor(Date.now() / 1000);
            const newLevel = Math.floor((currentTime - gameState.time) / 30) + 1;
            if (newLevel > gameState.level) {
                gameState.level = newLevel;
                // Ulecz gracza trochƒô przy levelup
                gameState.player.health = Math.min(gameState.player.maxHealth, gameState.player.health + 20);
            }
        }

        // Koniec gry
        function gameOver() {
            gameState.isRunning = false;
            document.getElementById('finalScore').textContent = `Finalne punkty: ${gameState.score}`;
            document.getElementById('gameOverScreen').style.display = 'flex';
        }

        // Restart gry
        function restartGame() {
            // Wyczy≈õƒá obszar gry
            const gameArea = document.getElementById('gameArea');
            gameArea.innerHTML = '';
            
            // Resetuj stan gry
            gameState = {
                isRunning: false,
                isPaused: false,
                player: {
                    x: window.innerWidth / 2,
                    y: window.innerHeight / 2,
                    health: 100,
                    maxHealth: 100,
                    element: null
                },
                enemies: [],
                projectiles: [],
                score: 0,
                time: Math.floor(Date.now() / 1000),
                level: 1,
                lastAttack: 0,
                keys: {}
            };
            
            // Ukryj ekran game over
            document.getElementById('gameOverScreen').style.display = 'none';
            
            // Rozpocznij nowƒÖ grƒô
            initGame();
        }

        // Event listeners
        document.getElementById('startButton').addEventListener('click', () => {
            gameState.time = Math.floor(Date.now() / 1000);
            initGame();
        });
        
        document.getElementById('restartButton').addEventListener('click', restartGame);

        // Zapobieganie scroll przy strza≈Çkach
        window.addEventListener('keydown', (e) => {
            if(['Space','ArrowUp','ArrowDown','ArrowLeft','ArrowRight'].indexOf(e.code) > -1) {
                e.preventDefault();
            }
        }, false);
    </script>
</body>
</html>